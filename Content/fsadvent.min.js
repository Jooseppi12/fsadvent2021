(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.IntelliFactory.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd;b=a.fsadvent=a.fsadvent||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Operators=d.Operators||{};f=d.Obj=d.Obj||{};g=d.UI=d.UI||{};h=g.Var=g.Var||{};i=a.StartupCode$fsadvent$Client=a.StartupCode$fsadvent$Client||{};j=d.JavaScript=d.JavaScript||{};k=j.Pervasives=j.Pervasives||{};l=g.Doc=g.Doc||{};m=g.Templating=g.Templating||{};n=m.Runtime=m.Runtime||{};o=n.Server=n.Server||{};p=o.TemplateInstance=o.TemplateInstance||{};q=d.Arrays=d.Arrays||{};r=o.ProviderBuilder=o.ProviderBuilder||{};s=d.List=d.List||{};t=o.Handler=o.Handler||{};u=g.View=g.View||{};v=d.Seq=d.Seq||{};w=d.Unchecked=d.Unchecked||{};x=a.fsadvent_Templates=a.fsadvent_Templates||{};y=a.fsadvent_Router=a.fsadvent_Router||{};z=c.EndPoint=c.EndPoint||{};A=g.Client=g.Client||{};B=A.Templates=A.Templates||{};C=g.Router=g.Router||{};D=g.Var$1=g.Var$1||{};E=d.Forms=d.Forms||{};F=E.Form=E.Form||{};G=j.JS=j.JS||{};H=d.Strings=d.Strings||{};I=d.Utils=d.Utils||{};J=g.Submitter=g.Submitter||{};K=a.System=a.System||{};L=K.Guid=K.Guid||{};M=d.Collections=d.Collections||{};N=M.List=M.List||{};O=s.T=s.T||{};P=M.FSharpSet=M.FSharpSet||{};Q=g.AttrModule=g.AttrModule||{};R=g.Snap=g.Snap||{};S=a.EventTarget;T=a.Node;U=M.Dictionary=M.Dictionary||{};V=d.Sitelets=d.Sitelets||{};W=V.RouterOperators=V.RouterOperators||{};X=V.RouterModule=V.RouterModule||{};Y=g.ConcreteVar=g.ConcreteVar||{};Z=M.BalancedTree=M.BalancedTree||{};_0=E.Fresh=E.Fresh||{};_1=g.Array=g.Array||{};_2=g.Docs=g.Docs||{};_3=a.Object;_4=g.AttrProxy=g.AttrProxy||{};_5=g.CheckedInput=g.CheckedInput||{};_6=d.Numeric=d.Numeric||{};_7=g.Attrs=g.Attrs||{};_8=g.DomUtility=g.DomUtility||{};_9=d.Enumerator=d.Enumerator||{};_=M.HashSet=M.HashSet||{};$=o.TemplateInitializer=o.TemplateInitializer||{};ba=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};bb=a.WindowOrWorkerGlobalScope;bc=V.Router=V.Router||{};bd=V.Route=V.Route||{};be=V.List=V.List||{};bf=d.Option=d.Option||{};bg=g.Abbrev=g.Abbrev||{};bh=bg.Fresh=bg.Fresh||{};bi=E.Result=E.Result||{};bj=g.DocElemNode=g.DocElemNode||{};bk=a.CharacterData;bl=Z.Tree=Z.Tree||{};bm=g.DynamicAttrNode=g.DynamicAttrNode||{};bn=M.DictionaryUtil=M.DictionaryUtil||{};bo=_9.T=_9.T||{};bp=B.Prepare=B.Prepare||{};bq=d.Slice=d.Slice||{};br=M.KeyCollection=M.KeyCollection||{};bs=g.An=g.An||{};bt=A.Settings=A.Settings||{};bu=bg.Mailbox=bg.Mailbox||{};bv=M.FSharpMap=M.FSharpMap||{};bw=M.Map=M.Map||{};bx=d.Concurrency=d.Concurrency||{};by=E.ErrorMessage=E.ErrorMessage||{};bz=a.StartupCode$WebSharper_Forms$Forms=a.StartupCode$WebSharper_Forms$Forms||{};bA=A.Attrs=A.Attrs||{};bB=bA.Dyn=bA.Dyn||{};bC=g.Elt=g.Elt||{};bD=A.Docs=A.Docs||{};bE=bD.RunState=bD.RunState||{};bF=bD.NodeSet=bD.NodeSet||{};bG=g.Anims=g.Anims||{};bH=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bI=M.Pair=M.Pair||{};bJ=d.Lazy=d.Lazy||{};bK=V.PathUtil=V.PathUtil||{};bL=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bM=g.Updates=g.Updates||{};bN=M.ValueCollection=M.ValueCollection||{};bO=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bP=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bQ=g.AppendList=g.AppendList||{};bR=M.HashSetUtil=M.HashSetUtil||{};bS=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bT=bS.LazyRecord=bS.LazyRecord||{};bU=M.MapUtil=M.MapUtil||{};bV=bx.Scheduler=bx.Scheduler||{};bW=d.Queue=d.Queue||{};bX=g.BindVar=g.BindVar||{};bY=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bZ=g.Easing=g.Easing||{};b0=bx.AsyncBody=bx.AsyncBody||{};b1=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};b2=bx.CT=bx.CT||{};b3=bg.HashSet=bg.HashSet||{};b4=g.String=g.String||{};b5=d.CancellationTokenSource=d.CancellationTokenSource||{};b6=bD.DomNodes=bD.DomNodes||{};b7=d.Char=d.Char||{};b8=a.Error;b9=d.OperationCanceledException=d.OperationCanceledException||{};b_=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b$=a.IntelliFactory;ca=b$&&b$.Runtime;cb=a.console;cc=a.Math;cd=a.Date;c.Main=function(){var ce;ce=l.BindView(function(cf){return cf.$==1?c.CheckoutView():c.HomeView();},c.routerInstance().get_View());B.LoadLocalTemplates("");l.RunById("main",ce);};c.routerInstance=function(){i.$cctor();return i.routerInstance;};c.CheckoutView=function(){return c.checkoutForm();};c.HomeView=function(){var ce,cf,cg,ch,ci,cj,ck;return(ce=(cf=(cg=(ch=s.map(function(cl){var cm,cn,co,cp,cq,cr,cs,ct;return(cm=(cn=(co=u.Const("disabled"),Q.DynamicPred("disabled",u.Map(function(cu){return v.contains(cl,cu);},c.itemsToOrder().get_View()),co)),(cp=(cq=(cr=new r.New$1(),(cr.h.push({$:1,$0:"name",$1:cl}),cr)),(cq.h.push(t.EventQ2(cq.k,"addtobasket",function(){return cq.i;},function(){c.itemsToOrder().Update(function(cu){return cu.Add(cl);});})),cq)),(cp.h.push({$:3,$0:"canbeadded",$1:cn}),cp))),(cs=t.CompleteHoles(cm.k,cm.h,[]),(ct=new p.New(cs[1],x.item(cs[0])),cm.i=ct,ct))).get_Doc();},c.items()),(ci=new r.New$1(),(ci.h.push({$:0,$0:"itemstoshopfor",$1:l.Concat(ch)}),ci))),(cg.h.push({$:0,$0:"itemstocheckout",$1:c.renderedBasket()}),cg)),(cf.h.push(t.EventQ2(cf.k,"gotocheckout",function(){return cf.i;},function(){c.routerInstance().Set(z.Checkout);})),cf)),(cj=t.CompleteHoles(ce.k,ce.h,[]),(ck=new p.New(cj[1],x.home(cj[0])),ce.i=ck,ck))).get_Doc();};c.checkoutForm=function(){i.$cctor();return i.checkoutForm;};c.renderedBasket=function(){i.$cctor();return i.renderedBasket;};c.items=function(){i.$cctor();return i.items;};c.itemsToOrder=function(){i.$cctor();return i.itemsToOrder;};c.router=function(){i.$cctor();return i.router;};c.basketForm=function(){i.$cctor();return i.basketForm;};e.FailWith=function(ce){throw new b8(ce);};e.KeyValue=function(ce){return[ce.K,ce.V];};f=d.Obj=ca.Class({Equals:function(ce){return this===ce;},GetHashCode:function(){return -1;}},null,f);f.New=ca.Ctor(function(){},f);h=g.Var=ca.Class({},f,h);h.New=ca.Ctor(function(){f.New.call(this);},h);i.$cctor=function(){i.$cctor=a.ignore;function ce(cf,cg){var ch;ch=l.BindView(function(ci){return l.Concat(s.map(function(cj){return l.Element("div",[],[l.Element("span",[],[l.TextNode(cj)]),l.Element("button",[Q.Handler("click",function(){return function(){return cf.Update(function(ck){return ck.Remove(cj);});};})],[l.TextNode("Remove")])]);},s.ofSeq(ci)));},cf.get_View());return l.Element("div",[],[l.Element("h1",[],[l.TextNode("Checkout")]),ch,l.Element("button",[Q.Handler("click",function(){return function(){return cg.Trigger();};})],[l.TextNode("Order")]),l.Element("button",[Q.Handler("click",function(){return function(){return c.routerInstance().Set(z.Home);};})],[l.TextNode("Go back")])]);}i.router=y.r();i.routerInstance=C.Install(z.Home,c.router());i.itemsToOrder=D.Create$1(new P.New$1(null));i.items=s.ofArray(["apple","orange","banana","grape","pear"]);i.basketForm=F.WithSubmit(F.YieldVar(c.itemsToOrder()));i.checkoutForm=F.Render(function(cf){return function(cg){return ce(cf,cg);};},F.Run(function(cf){a.alert((function(cg){return function(ch){return cg("You have ordered: "+I.toSafe(ch));};}(a.id))(H.concat(",",cf)));},c.basketForm()));i.renderedBasket=c.basketForm().render(function(cf){return function(){return l.BindView(function(cg){return l.Concat(s.map(function(ch){return l.Element("div",[],[l.TextNode(ch)]);},s.ofSeq(cg)));},cf.get_View());};});};k.NewFromSeq=function(ce){var cf,cg,ch;cf={};cg=_9.Get(ce);try{while(cg.MoveNext()){ch=cg.Current();cf[ch[0]]=ch[1];}}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}return cf;};l=g.Doc=ca.Class({},f,l);l.BindView=function(ce,cf){return l.EmbedView(u.Map(ce,cf));};l.RunById=function(ce,cf){var cg;cg=self.document.getElementById(ce);if(w.Equals(cg,null))e.FailWith("invalid id: "+ce);else l.Run(cg,cf);};l.Concat=function(ce){var cf;cf=_1.ofSeqNonCopying(ce);return _1.TreeReduce(l.get_Empty(),l.Append,cf);};l.EmbedView=function(ce){var cf;cf=_2.CreateEmbedNode();return l.Mk({$:2,$0:cf},u.Map(a.ignore,u.Bind(function(cg){_2.UpdateEmbedNode(cf,cg.docNode);return cg.updates;},ce)));};l.Run=function(ce,cf){_2.LinkElement(ce,cf.docNode);l.RunInPlace(false,ce,cf);};l.Append=function(ce,cf){return l.Mk({$:0,$0:ce.docNode,$1:cf.docNode},u.Map2Unit(ce.updates,cf.updates));};l.get_Empty=function(){return l.Mk(null,u.Const());};l.TextNode=function(ce){return l.Mk({$:5,$0:self.document.createTextNode(ce)},u.Const());};l.Mk=function(ce,cf){return new l.New(ce,cf);};l.RunInPlace=function(ce,cf,cg){var ch;ch=_2.CreateRunState(cf,cg.docNode);u.Sink(bs.get_UseAnimations()||bt.BatchUpdatesEnabled()?bu.StartProcessor(_2.PerformAnimatedUpdate(ce,ch,cg.docNode)):function(){_2.PerformSyncUpdate(ce,ch,cg.docNode);},cg.updates);};l.Element=function(ce,cf,cg){var ch,ci;ch=_4.Concat(cf);ci=l.Concat(cg);return bC.New(self.document.createElement(ce),ch,ci);};l.TextView=function(ce){var cf;cf=_2.CreateTextNode();return l.Mk({$:4,$0:cf},u.Map(function(cg){_2.UpdateTextNode(cf,cg);},ce));};l.New=ca.Ctor(function(ce,cf){f.New.call(this);this.docNode=ce;this.updates=cf;},l);p=o.TemplateInstance=ca.Class({get_Doc:function(){return this.doc;}},f,p);p.New=ca.Ctor(function(ce,cf){f.New.call(this);this.doc=cf;this.allVars=ce.$==0?ce.$0:e.FailWith("Should not happen");},p);q.get=function(ce,cf){q.checkBounds(ce,cf);return ce[cf];};q.length=function(ce){return ce.dims===2?ce.length*ce.length:ce.length;};q.checkBounds=function(ce,cf){if(cf<0||cf>=ce.length)e.FailWith("Index was outside the bounds of the array.");};q.set=function(ce,cf,cg){q.checkBounds(ce,cf);ce[cf]=cg;};r=o.ProviderBuilder=ca.Class({},f,r);r.New$1=ca.Ctor(function(){var ce;f.New.call(this);this.i=null;this.k=(ce=L.NewGuid(),a.String(ce));this.h=[];ca.SetOptional(this,"s",null);},r);s.map=function(ce,cf){var cg,ch,ci,cj,ck;if(cf.$==0)return cf;else{cj=new O({$:1});cg=cj;ch=cf;ci=true;while(ci){cg.$0=ce(ch.$0);ch=ch.$1;if(ch.$==0)ci=false;else cg=(ck=new O({$:1}),cg.$1=ck,ck);}cg.$1=O.Empty;return cj;}};s.ofArray=function(ce){var cf,cg,ch;cf=O.Empty;for(cg=q.length(ce)-1,ch=0;cg>=ch;cg--)cf=new O({$:1,$0:q.get(ce,cg),$1:cf});return cf;};s.rev=function(ce){var cf,cg;cf=O.Empty;cg=ce;while(cg.$==1){cf=new O({$:1,$0:cg.$0,$1:cf});cg=cg.$1;}return cf;};s.ofSeq=function(ce){var cf,cg,ch,ci,cj,ck;if(ce instanceof O)return ce;else if(ce instanceof a.Array)return s.ofArray(ce);else{cf=_9.Get(ce);try{ch=cf.MoveNext();if(!ch)cg=O.Empty;else{cj=new O({$:1});ci=cj;while(ch){ci.$0=cf.Current();if(cf.MoveNext())ci=(ck=new O({$:1}),ci.$1=ck,ck);else ch=false;}ci.$1=O.Empty;cg=cj;}return cg;}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}}};s.head=function(ce){return ce.$==1?ce.$0:s.listEmpty();};s.tail=function(ce){return ce.$==1?ce.$1:s.listEmpty();};s.listEmpty=function(){return e.FailWith("The input list was empty.");};s.iter=function(ce,cf){var cg;cg=cf;while(cg.$==1){ce(s.head(cg));cg=s.tail(cg);}};t.EventQ2=function(ce,cf,cg,ch){return{$:5,$0:cf,$1:function(ci){return function(cj){return ch({Vars:cg(),Target:ci,Event:cj});};}};};t.CompleteHoles=function(ce,cf,cg){var ci,cj,ck,cl,cm;function ch(cn,co){var cp;return cj.Contains(cn)?null:(cp=w.Equals(co,0)?$.GetOrAddHoleFor(ce,cn,function(){return{$:8,$0:cn,$1:D.Create$1("")};}):w.Equals(co,1)?$.GetOrAddHoleFor(ce,cn,function(){return{$:13,$0:cn,$1:D.Create$1(0)};}):w.Equals(co,2)?$.GetOrAddHoleFor(ce,cn,function(){return{$:9,$0:cn,$1:D.Create$1(false)};}):e.FailWith("Invalid value type"),(ci.set_Item(cn,cp),{$:1,$0:cp}));}ci=new U.New$5();cj=new _.New$3();ck=_9.Get(cf);try{while(ck.MoveNext()){cl=ck.Current();cm=cl.$0;cj.Add(cm);ci.set_Item(cm,cl);}}finally{if(typeof ck=="object"&&"Dispose"in ck)ck.Dispose();}return[v.append(cf,q.choose(function(cn){return ch(cn[0],cn[1]);},cg)),{$:0,$0:ci}];};u=g.View=ca.Class({},null,u);v.append=function(ce,cf){return{GetEnumerator:function(){var cg,ch;cg=_9.Get(ce);ch=[true];return new bo.New(cg,null,function(ci){var cj;return ci.s.MoveNext()?(ci.c=ci.s.Current(),true):(cj=ci.s,!w.Equals(cj,null)?cj.Dispose():void 0,ci.s=null,ch[0]&&(ch[0]=false,ci.s=_9.Get(cf),ci.s.MoveNext()?(ci.c=ci.s.Current(),true):(ci.s.Dispose(),ci.s=null,false)));},function(ci){var cj;cj=ci.s;if(!w.Equals(cj,null))cj.Dispose();});}};};v.head=function(ce){var cf;cf=_9.Get(ce);try{return cf.MoveNext()?cf.Current():v.insufficient();}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}};v.iteri=function(ce,cf){var cg,ch;cg=0;ch=_9.Get(cf);try{while(ch.MoveNext()){ce(cg,ch.Current());cg=cg+1;}}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}};v.collect=function(ce,cf){return v.concat(v.map(ce,cf));};v.indexed=function(ce){return v.mapi(function(cf,cg){return[cf,cg];},ce);};v.map=function(ce,cf){return{GetEnumerator:function(){var cg;cg=_9.Get(cf);return new bo.New(null,null,function(ch){return cg.MoveNext()&&(ch.c=ce(cg.Current()),true);},function(){cg.Dispose();});}};};v.tryFindIndex=function(ce,cf){var cg,ch,ci;cg=_9.Get(cf);try{ch=true;ci=0;while(ch&&cg.MoveNext())if(ce(cg.Current()))ch=false;else ci=ci+1;return ch?null:{$:1,$0:ci};}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}};v.tryPick=function(ce,cf){var cg,ch;cg=_9.Get(cf);try{ch=null;while(w.Equals(ch,null)&&cg.MoveNext())ch=ce(cg.Current());return ch;}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}};v.concat=function(ce){return{GetEnumerator:function(){var cf;function cg(ch){var ci;while(true){ci=ch.s;if(w.Equals(ci,null)){if(cf.MoveNext()){ch.s=_9.Get(cf.Current());ch=ch;}else{cf.Dispose();return false;}}else if(ci.MoveNext()){ch.c=ci.Current();return true;}else{ch.Dispose();ch.s=null;ch=ch;}}}cf=_9.Get(ce);return new bo.New(null,null,cg,function(ch){var ci;ci=ch.s;if(!w.Equals(ci,null))ci.Dispose();if(!w.Equals(cf,null))cf.Dispose();});}};};v.mapi=function(ce,cf){return v.map2(ce,v.initInfinite(a.id),cf);};v.fold=function(ce,cf,cg){var ch,ci;ch=cf;ci=_9.Get(cg);try{while(ci.MoveNext())ch=ce(ch,ci.Current());return ch;}finally{if(typeof ci=="object"&&"Dispose"in ci)ci.Dispose();}};v.forall2=function(ce,cf,cg){return!v.exists2(function(ch,ci){return!ce(ch,ci);},cf,cg);};v.map2=function(ce,cf,cg){return{GetEnumerator:function(){var ch,ci;ch=_9.Get(cf);ci=_9.Get(cg);return new bo.New(null,null,function(cj){return ch.MoveNext()&&ci.MoveNext()&&(cj.c=ce(ch.Current(),ci.Current()),true);},function(){ch.Dispose();ci.Dispose();});}};};v.initInfinite=function(ce){return{GetEnumerator:function(){return new bo.New(0,null,function(cf){cf.c=ce(cf.s);cf.s=cf.s+1;return true;},void 0);}};};v.exists2=function(ce,cf,cg){var ch,ci,cj,ck;ch=_9.Get(cf);try{cj=_9.Get(cg);try{ck=false;while(!ck&&ch.MoveNext()&&cj.MoveNext())ck=ce(ch.Current(),cj.Current());ci=ck;}finally{if(typeof cj=="object"&&"Dispose"in cj)cj.Dispose();}return ci;}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}};v.unfold=function(ce,cf){return{GetEnumerator:function(){return new bo.New(cf,null,function(cg){var ch;ch=ce(cg.s);return ch==null?false:(cg.c=ch.$0[0],cg.s=ch.$0[1],true);},void 0);}};};v.iter=function(ce,cf){var cg;cg=_9.Get(cf);try{while(cg.MoveNext())ce(cg.Current());}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}};v.rev=function(ce){return v.delay(function(){return q.ofSeq(ce).slice().reverse();});};v.distinctBy=function(ce,cf){return{GetEnumerator:function(){var cg,ch;cg=_9.Get(cf);ch=new _.New$3();return new bo.New(null,null,function(ci){var cj,ck;if(cg.MoveNext()){cj=cg.Current();ck=ch.Add(ce(cj));while(!ck&&cg.MoveNext()){cj=cg.Current();ck=ch.Add(ce(cj));}return ck&&(ci.c=cj,true);}else return false;},function(){cg.Dispose();});}};};v.max=function(ce){var cf,cg,ch;cf=_9.Get(ce);try{if(!cf.MoveNext())v.seqEmpty();cg=cf.Current();while(cf.MoveNext()){ch=cf.Current();if(w.Compare(ch,cg)===1)cg=ch;}return cg;}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}};v.delay=function(ce){return{GetEnumerator:function(){return _9.Get(ce());}};};v.distinct=function(ce){return v.distinctBy(a.id,ce);};v.seqEmpty=function(){return e.FailWith("The input sequence was empty.");};v.compareWith=function(ce,cf,cg){var ch,ci,cj,ck,cl;ch=_9.Get(cf);try{cj=_9.Get(cg);try{ck=0;cl=true;while(cl&&ck===0)if(ch.MoveNext())ck=cj.MoveNext()?ce(ch.Current(),cj.Current()):1;else if(cj.MoveNext())ck=-1;else cl=false;ci=ck;}finally{if(typeof cj=="object"&&"Dispose"in cj)cj.Dispose();}return ci;}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}};v.forall=function(ce,cf){return!v.exists(function(cg){return!ce(cg);},cf);};v.exists=function(ce,cf){var cg,ch;cg=_9.Get(cf);try{ch=false;while(!ch&&cg.MoveNext())ch=ce(cg.Current());return ch;}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}};u.Const=function(ce){var cf;cf=R.New({$:0,$0:ce});return function(){return cf;};};u.Map=function(ce,cf){return u.CreateLazy(function(){return R.Map(ce,cf());});};u.Bind=function(ce,cf){return u.Join(u.Map(ce,cf));};u.CreateLazy=function(ce){var cf;cf={c:null,o:ce};return function(){var cg,ch;cg=cf.c;return cg===null?(cg=cf.o(),cf.c=cg,(ch=cg.s,ch!=null&&ch.$==0)?cf.o=null:R.WhenObsoleteRun(cg,function(){cf.c=null;}),cg):cg;};};u.Map2=function(ce,cf,cg){return u.CreateLazy(function(){return R.Map2(ce,cf(),cg());});};u.Sink=function(ce,cf){function cg(){R.WhenRun(cf(),ce,function(){bx.scheduler().Fork(cg);});}bx.scheduler().Fork(cg);};u.Map2Unit=function(ce,cf){return u.CreateLazy(function(){return R.Map2Unit(ce(),cf());});};u.Join=function(ce){return u.CreateLazy(function(){return R.Join(ce());});};u.SnapshotOn=function(ce,cf,cg){var ch;ch=R.New({$:2,$0:ce,$1:[]});return u.CreateLazy(function(){return ch.s==null?R.SnapshotOn(cf(),cg()):(R.WhenObsolete(cf(),ch),ch);});};u.Map3=function(ce,cf,cg,ch){return u.CreateLazy(function(){return R.Map3(ce,cf(),cg(),ch());});};u.Sequence=function(ce){return u.CreateLazy(function(){return R.Sequence(v.map(function(cf){return cf();},ce));});};w.Equals=function(ce,cf){var cg,ch,ci,cj;if(ce===cf)return true;else{cg=typeof ce;if(cg=="object"){if(ce===null||ce===void 0||cf===null||cf===void 0||!w.Equals(typeof cf,"object"))return false;else if("Equals"in ce)return ce.Equals(cf);else if("Equals"in cf)return false;else if(ce instanceof a.Array&&cf instanceof a.Array)return w.arrayEquals(ce,cf);else if(ce instanceof a.Date&&cf instanceof a.Date)return w.dateEquals(ce,cf);else{ch=[true];for(var ck in ce)if(function(cl){ch[0]=!ce.hasOwnProperty(cl)||cf.hasOwnProperty(cl)&&w.Equals(ce[cl],cf[cl]);return!ch[0];}(ck))break;if(ch[0]){for(var cl in cf)if(function(cm){ch[0]=!cf.hasOwnProperty(cm)||ce.hasOwnProperty(cm);return!ch[0];}(cl))break;}return ch[0];}}else return cg=="function"&&("$Func"in ce?ce.$Func===cf.$Func&&ce.$Target===cf.$Target:"$Invokes"in ce&&"$Invokes"in cf&&w.arrayEquals(ce.$Invokes,cf.$Invokes));}};w.arrayEquals=function(ce,cf){var cg,ch;if(q.length(ce)===q.length(cf)){cg=true;ch=0;while(cg&&ch<q.length(ce)){!w.Equals(q.get(ce,ch),q.get(cf,ch))?cg=false:void 0;ch=ch+1;}return cg;}else return false;};w.dateEquals=function(ce,cf){return ce.getTime()===cf.getTime();};w.Hash=function(ce){var cf;cf=typeof ce;return cf=="function"?0:cf=="boolean"?ce?1:0:cf=="number"?ce:cf=="string"?w.hashString(ce):cf=="object"?ce==null?0:ce instanceof a.Array?w.hashArray(ce):w.hashObject(ce):0;};w.hashString=function(ce){var cf,cg,ch;if(ce===null)return 0;else{cf=5381;for(cg=0,ch=ce.length-1;cg<=ch;cg++)cf=w.hashMix(cf,ce[cg].charCodeAt());return cf;}};w.hashArray=function(ce){var cf,cg,ch;cf=-34948909;for(cg=0,ch=q.length(ce)-1;cg<=ch;cg++)cf=w.hashMix(cf,w.Hash(q.get(ce,cg)));return cf;};w.hashObject=function(ce){var cf,cg;if("GetHashCode"in ce)return ce.GetHashCode();else{cf=[0];for(var ch in ce)if(function(ci){cf[0]=w.hashMix(w.hashMix(cf[0],w.hashString(ci)),w.Hash(ce[ci]));return false;}(ch))break;return cf[0];}};w.Compare=function(ce,cf){var cg,ch,ci,cj,ck,cl;if(ce===cf)return 0;else{ch=typeof ce;switch(ch=="function"?1:ch=="boolean"?2:ch=="number"?2:ch=="string"?2:ch=="object"?3:0){case 0:return typeof cf=="undefined"?0:-1;case 1:return e.FailWith("Cannot compare function values.");case 2:return ce<cf?-1:1;case 3:if(ce===null)ci=-1;else if(cf===null)ci=1;else if("CompareTo"in ce)ci=ce.CompareTo(cf);else if("CompareTo0"in ce)ci=ce.CompareTo0(cf);else if(ce instanceof a.Array&&cf instanceof a.Array)ci=w.compareArrays(ce,cf);else if(ce instanceof a.Date&&cf instanceof a.Date)ci=w.compareDates(ce,cf);else{cj=[0];for(var cm in ce)if(function(cn){return!ce.hasOwnProperty(cn)?false:!cf.hasOwnProperty(cn)?(cj[0]=1,true):(cj[0]=w.Compare(ce[cn],cf[cn]),cj[0]!==0);}(cm))break;if(cj[0]===0){for(var cn in cf)if(function(co){return!cf.hasOwnProperty(co)?false:!ce.hasOwnProperty(co)&&(cj[0]=-1,true);}(cn))break;}ci=cj[0];}return ci;}}};w.hashMix=function(ce,cf){return(ce<<5)+ce+cf;};w.compareArrays=function(ce,cf){var cg,ch;if(q.length(ce)<q.length(cf))return -1;else if(q.length(ce)>q.length(cf))return 1;else{cg=0;ch=0;while(cg===0&&ch<q.length(ce)){cg=w.Compare(q.get(ce,ch),q.get(cf,ch));ch=ch+1;}return cg;}};w.compareDates=function(ce,cf){return w.Compare(ce.getTime(),cf.getTime());};x.item=function(ce){B.LoadLocalTemplates("index");return ce?B.NamedTemplate("index",{$:1,$0:"item"},ce):void 0;};x.home=function(ce){B.LoadLocalTemplates("index");return ce?B.NamedTemplate("index",{$:1,$0:"home"},ce):void 0;};y.r=function(){return W.JSUnion(void 0,[[null,[[null,[]]],[]],[null,[[null,["checkout"]]],[]]]);};z.Checkout={$:1};z.Home={$:0};B.LoadLocalTemplates=function(ce){!B.LocalTemplatesLoaded()?(B.set_LocalTemplatesLoaded(true),B.LoadNestedTemplates(self.document.body,"")):void 0;B.LoadedTemplates().set_Item(ce,B.LoadedTemplateFile(""));};B.LocalTemplatesLoaded=function(){ba.$cctor();return ba.LocalTemplatesLoaded;};B.set_LocalTemplatesLoaded=function(ce){ba.$cctor();ba.LocalTemplatesLoaded=ce;};B.LoadNestedTemplates=function(ce,cf){var ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct;function cg(cu){var cv,cw;if(!ch.ContainsKey(cu)){cv=(cw=null,[ci.TryGetValue(cu,{get:function(){return cw;},set:function(cx){cw=cx;}}),cw]);if(cv[0]){ct.Add(cu);ci.Remove(cu);B.PrepareTemplateStrict(cf,{$:1,$0:cu},cv[1],{$:1,$0:cg});}else cb.warn(ct.Contains(cu)?"Encountered loop when instantiating "+cu:"Local template does not exist: "+cu);}}ch=B.LoadedTemplateFile(cf);ci=new U.New$5();cj=ce.querySelectorAll("[ws-template]");for(ck=0,cl=cj.length-1;ck<=cl;ck++){cm=cj[ck];cn=cm.getAttribute("ws-template").toLowerCase();cm.removeAttribute("ws-template");ci.set_Item(cn,B.FakeRootSingle(cm));}co=ce.querySelectorAll("[ws-children-template]");for(cp=0,cq=co.length-1;cp<=cq;cp++){cr=co[cp];cs=cr.getAttribute("ws-children-template").toLowerCase();cr.removeAttribute("ws-children-template");ci.set_Item(cs,B.FakeRoot(cr));}ct=new _.New$3();while(ci.count>0)cg(v.head(ci.get_Keys()));};B.LoadedTemplates=function(){ba.$cctor();return ba.LoadedTemplates;};B.LoadedTemplateFile=function(ce){var cf,cg,ch;cf=(cg=null,[B.LoadedTemplates().TryGetValue(ce,{get:function(){return cg;},set:function(ci){cg=ci;}}),cg]);return cf[0]?cf[1]:(ch=new U.New$5(),(B.LoadedTemplates().set_Item(ce,ch),ch));};B.NamedTemplate=function(ce,cf,cg){var ch,ci;ch=(ci=null,[B.LoadedTemplateFile(ce).TryGetValue(cf==null?"":cf.$0,{get:function(){return ci;},set:function(cj){ci=cj;}}),ci]);return ch[0]?B.ChildrenTemplate(ch[1].cloneNode(true),cg):(cb.warn("Local template doesn't exist",cf),l.get_Empty());};B.FakeRootSingle=function(ce){var cf,cg,ch,ci;ce.removeAttribute("ws-template");cf=ce.getAttribute("ws-replace");if(cf===null);else{ce.removeAttribute("ws-replace");cg=ce.parentNode;w.Equals(cg,null)?void 0:(ch=self.document.createElement(ce.tagName),ch.setAttribute("ws-replace",cf),cg.replaceChild(ch,ce));}ci=self.document.createElement("div");ci.appendChild(ce);return ci;};B.FakeRoot=function(ce){var cf;cf=self.document.createElement("div");while(ce.hasChildNodes())cf.appendChild(ce.firstChild);return cf;};B.PrepareTemplateStrict=function(ce,cf,cg,ch){var ci;function cj(cp,cq){var cr,cs,ct,cu,cv,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR;function cw(cS){}while(true)switch(cp){case 0:if(cq!==null){cr=cq.nextSibling;if(w.Equals(cq.nodeType,T.TEXT_NODE))bp.convertTextNode(cq);else if(w.Equals(cq.nodeType,T.ELEMENT_NODE))cl(cq);cq=cr;}else return null;break;case 1:cx=bq.string(cq.nodeName,{$:1,$0:3},null).toLowerCase();cy=(cs=cx.indexOf("."),cs===-1?[ce,cx]:[bq.string(cx,null,{$:1,$0:cs-1}),bq.string(cx,{$:1,$0:cs+1},null)]);cz=cy[1];cA=cy[0];if(cA!==""&&!B.LoadedTemplates().ContainsKey(cA))return bp.failNotLoaded(cz);else{if(cA===""&&ch!=null)ch.$0(cz);cB=B.LoadedTemplates().get_Item(cA);if(!cB.ContainsKey(cz))return bp.failNotLoaded(cz);else{cC=cB.get_Item(cz);cD=cC.cloneNode(true);cE=new _.New$3();cF=new U.New$5();cG=cq.attributes;for(cH=0,cI=cG.length-1;cH<=cI;cH++){cJ=cG.item(cH).name.toLowerCase();cF.set_Item(cJ,(cK=cG.item(cH).nodeValue,cK===""?cJ:cK.toLowerCase()));if(!cE.Add(cJ))cb.warn("Hole mapped twice",cJ);}for(cL=0,cM=cq.childNodes.length-1;cL<=cM;cL++){cN=cq.childNodes[cL];if(w.Equals(cN.nodeType,T.ELEMENT_NODE))!cE.Add(cN.nodeName.toLowerCase())?cb.warn("Hole filled twice",cz):void 0;}cO=cq.childNodes.length===1&&w.Equals(cq.firstChild.nodeType,T.TEXT_NODE);if(cO){cu=bp.fillTextHole(cD,cq.firstChild.textContent,cz);((function(cS){return function(cT){if(cT!=null)cS(cT.$0);};}((cv=function(cS){return function(cT){return cS.Add(cT);};}(cE),function(cS){return cw(cv(cS));})))(cu));}bp.removeHolesExcept(cD,cE);if(!cO){for(cP=0,cQ=cq.childNodes.length-1;cP<=cQ;cP++){cR=cq.childNodes[cP];if(w.Equals(cR.nodeType,T.ELEMENT_NODE))cR.hasAttributes()?bp.fillInstanceAttrs(cD,cR):ck(cD,cR);}}bp.mapHoles(cD,cF);bp.fill(cD,cq.parentNode,cq);cq.parentNode.removeChild(cq);return;}}break;}}function ck(cp,cq){var cr,ct,cu;function cs(cv,cw){var cx;if(ct==="title"&&cq.hasChildNodes()){cx=_8.ParseHTMLIntoFakeRoot(cq.textContent);cq.removeChild(cq.firstChild);while(cx.hasChildNodes())cq.appendChild(cx.firstChild);}else null;cl(cq);return bp.fill(cq,cv,cw);}ct=cq.nodeName.toLowerCase();B.foreachNotPreserved(cp,"[ws-attr-holes]",function(cv){var cw,cx,cy,cz,cA;cw=H.SplitChars(cv.getAttribute("ws-attr-holes"),[" "],1);for(cx=0,cy=cw.length-1;cx<=cy;cx++){cz=q.get(cw,cx);cv.setAttribute(cz,(cA=new a.RegExp("\\${"+ct+"}","ig"),cv.getAttribute(cz).replace(cA,cq.textContent)));}});cu=cp.querySelector("[ws-hole="+ct+"]");if(w.Equals(cu,null)){cr=cp.querySelector("[ws-replace="+ct+"]");return w.Equals(cr,null)?null:(cs(cr.parentNode,cr),void cr.parentNode.removeChild(cr));}else{while(cu.hasChildNodes())cu.removeChild(cu.lastChild);cu.removeAttribute("ws-hole");return cs(cu,null);}}function cl(cp){if(!cp.hasAttribute("ws-preserve"))if(H.StartsWith(cp.nodeName.toLowerCase(),"ws-"))cn(cp);else{bp.convertAttrs(cp);cm(cp.firstChild);}}function cm(cp){return cj(0,cp);}function cn(cp){return cj(1,cp);}function co(cp){var cq,cr,cs,ct;while(true){cq=cp.querySelector("[ws-template]");if(w.Equals(cq,null)){cr=cp.querySelector("[ws-children-template]");if(w.Equals(cr,null))return null;else{cs=cr.getAttribute("ws-children-template");cr.removeAttribute("ws-children-template");B.PrepareTemplateStrict(ce,{$:1,$0:cs},cr,null);cp=cp;}}else{ct=cq.getAttribute("ws-template");(B.PrepareSingleTemplate(ce,{$:1,$0:ct},cq))(null);cp=cp;}}}ci=(cf==null?"":cf.$0).toLowerCase();B.LoadedTemplateFile(ce).set_Item(ci,cg);if(cg.hasChildNodes()){co(cg);cm(cg.firstChild);}};B.ChildrenTemplate=function(ce,cf){var cg,ch,ci,cj,ck;cg=B.InlineTemplate(ce,v.append(cf,B.GlobalHoles().get_Values()));ch=cg[1];ci=cg[0];cj=ci.Els;return!w.Equals(cj,null)&&cj.length===1&&(q.get(cj,0)instanceof T&&(w.Equals(q.get(cj,0).nodeType,T.ELEMENT_NODE)&&(ck=q.get(cj,0),true)))?bC.TreeNode(ci,ch):l.Mk({$:6,$0:ci},ch);};B.foreachNotPreserved=function(ce,cf,cg){_8.IterSelector(ce,cf,function(ch){if(ch.closest("[ws-preserve]")==null)cg(ch);});};B.PrepareSingleTemplate=function(ce,cf,cg){var ch;ch=B.FakeRootSingle(cg);return function(ci){B.PrepareTemplateStrict(ce,cf,ch,ci);};};B.InlineTemplate=function(ce,cf){var cg,ch,ci,cj,cm,cn,co,cp,cq,cr,cs;function ck(ct,cu){var cv,cw,cx;cv=_7.Insert(ct,cu);cn.push(_7.Updates(cv));co.push([ct,cv]);cw=ca.GetOptional(cv.OnAfterRender);return cw==null?null:(cx=cw.$0,void cp.push(function(){cx(ct);}));}function cl(ct){var cu,cv;cu=(cv=null,[cq.TryGetValue(ct,{get:function(){return cv;},set:function(cw){cv=cw;}}),cv]);return cu[0]?cu[1].$==0?{$:1,$0:cu[1].$1}:cu[1].$==1?{$:1,$0:l.TextNode(cu[1].$1)}:cu[1].$==2?{$:1,$0:l.TextView(cu[1].$1)}:cu[1].$==8?{$:1,$0:l.TextView(cu[1].$1.get_View())}:cu[1].$==9?{$:1,$0:l.TextView(u.Map(a.String,cu[1].$1.get_View()))}:cu[1].$==10?{$:1,$0:l.TextView(u.Map(function(cw){return cw.get_Input();},cu[1].$1.get_View()))}:cu[1].$==11?{$:1,$0:l.TextView(u.Map(a.String,cu[1].$1.get_View()))}:cu[1].$==12?{$:1,$0:l.TextView(u.Map(function(cw){return cw.get_Input();},cu[1].$1.get_View()))}:cu[1].$==13?{$:1,$0:l.TextView(u.Map(a.String,cu[1].$1.get_View()))}:(cb.warn("Content hole filled with attribute data",ct),null):null;}cm=[];cn=[];co=[];cp=[];cq=new U.New$5();cr=_9.Get(cf);try{while(cr.MoveNext()){cs=cr.Current();cq.set_Item(cs.$0,cs);}}finally{if(typeof cr=="object"&&"Dispose"in cr)cr.Dispose();}cg=_8.ChildrenArray(ce);B.foreachNotPreserved(ce,"[ws-hole]",function(ct){var cu,cv,cw;cw=ct.getAttribute("ws-hole");ct.removeAttribute("ws-hole");while(ct.hasChildNodes())ct.removeChild(ct.lastChild);cu=cl(cw);if(cu!=null&&cu.$==1){cv=cu.$0;_2.LinkElement(ct,cv.docNode);cm.push(bj.New(_7.Empty(ct),cv.docNode,null,ct,bh.Int(),null));cn.push(cv.updates);}});B.foreachNotPreserved(ce,"[ws-replace]",function(ct){var cu,cv,cw,cx,cy,cz;cu=cl(ct.getAttribute("ws-replace"));if(cu!=null&&cu.$==1){cv=cu.$0;cw=ct.parentNode;cx=self.document.createTextNode("");cw.replaceChild(cx,ct);cy=_2.InsertBeforeDelim(cx,cv.docNode);cz=q.tryFindIndex(function(cA){return ct===cA;},cg);cz==null?void 0:q.set(cg,cz.$0,cv.docNode);cm.push(bj.New(_7.Empty(cw),cv.docNode,{$:1,$0:[cy,cx]},cw,bh.Int(),null));cn.push(cv.updates);}});B.foreachNotPreserved(ce,"[ws-attr]",function(ct){var cu,cv,cw;cu=ct.getAttribute("ws-attr");ct.removeAttribute("ws-attr");cv=(cw=null,[cq.TryGetValue(cu,{get:function(){return cw;},set:function(cx){cw=cx;}}),cw]);if(cv[0])cv[1].$==3?ck(ct,cv[1].$1):cb.warn("Attribute hole filled with non-attribute data",cu);});B.foreachNotPreserved(ce,"[ws-on]",function(ct){ck(ct,_4.Concat(q.choose(function(cu){var cv,cw,cx;cv=H.SplitChars(cu,[":"],1);cw=(cx=null,[cq.TryGetValue(q.get(cv,1),{get:function(){return cx;},set:function(cy){cx=cy;}}),cx]);return cw[0]?cw[1].$==4?{$:1,$0:Q.Handler(q.get(cv,0),cw[1].$1)}:cw[1].$==5?{$:1,$0:_4.Handler(q.get(cv,0),cw[1].$1)}:(cb.warn("Event hole on"+q.get(cv,0)+" filled with non-event data",q.get(cv,1)),null):null;},H.SplitChars(ct.getAttribute("ws-on"),[" "],1))));ct.removeAttribute("ws-on");});B.foreachNotPreserved(ce,"[ws-onafterrender]",function(ct){var cu,cv,cw;cu=ct.getAttribute("ws-onafterrender");cv=(cw=null,[cq.TryGetValue(cu,{get:function(){return cw;},set:function(cx){cw=cx;}}),cw]);if(cv[0])cv[1].$==6?(ct.removeAttribute("ws-onafterrender"),ck(ct,Q.OnAfterRender(cv[1].$1))):cv[1].$==7?(ct.removeAttribute("ws-onafterrender"),ck(ct,Q.OnAfterRender(cv[1].$1))):cb.warn("onafterrender hole filled with non-onafterrender data",cu);});B.foreachNotPreserved(ce,"[ws-var]",function(ct){var cu,cv,cw;cu=ct.getAttribute("ws-var");ct.removeAttribute("ws-var");cv=(cw=null,[cq.TryGetValue(cu,{get:function(){return cw;},set:function(cx){cw=cx;}}),cw]);if(cv[0])cv[1].$==8?ck(ct,Q.Value(cv[1].$1)):cv[1].$==9?ck(ct,Q.Checked(cv[1].$1)):cv[1].$==10?ck(ct,Q.IntValue(cv[1].$1)):cv[1].$==11?ck(ct,Q.IntValueUnchecked(cv[1].$1)):cv[1].$==12?ck(ct,Q.FloatValue(cv[1].$1)):cv[1].$==13?ck(ct,Q.FloatValueUnchecked(cv[1].$1)):cb.warn("Var hole filled with non-Var data",cu);});B.foreachNotPreserved(ce,"[ws-attr-holes]",function(ct){var cu,cv,cw,cx;cu=new a.RegExp(B.TextHoleRE(),"g");cv=H.SplitChars(ct.getAttribute("ws-attr-holes"),[" "],1);ct.removeAttribute("ws-attr-holes");for(cw=0,cx=cv.length-1;cw<=cx;cw++)(function(){var cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK;cH=q.get(cv,cw);cI=ct.getAttribute(cH);cy=null;cz=0;cJ=[];while(cy=cu.exec(cI),cy!==null){cK=bq.string(cI,{$:1,$0:cz},{$:1,$0:cu.lastIndex-q.get(cy,0).length-1});cz=cu.lastIndex;cJ.push([cK,q.get(cy,1)]);}cB=bq.string(cI,{$:1,$0:cz},null);cu.lastIndex=0;cC=q.foldBack(function(cL,cM){return(function(cN){var cO,cP;cO=cN[0];cP=cN[1];return function(cQ){var cR,cS,cT,cU,cV;cR=cQ[0];cS=cQ[1];cT=(cU=(cV=null,[cq.TryGetValue(cP,{get:function(){return cV;},set:function(cW){cV=cW;}}),cV]),cU[0]?cU[1].$==1?{$:0,$0:cU[1].$1}:cU[1].$==2?{$:1,$0:cU[1].$1}:cU[1].$==8?{$:1,$0:cU[1].$1.get_View()}:cU[1].$==9?{$:1,$0:u.Map(a.String,cU[1].$1.get_View())}:cU[1].$==10?{$:1,$0:u.Map(function(cW){return cW.get_Input();},cU[1].$1.get_View())}:cU[1].$==11?{$:1,$0:u.Map(a.String,cU[1].$1.get_View())}:cU[1].$==12?{$:1,$0:u.Map(function(cW){return cW.get_Input();},cU[1].$1.get_View())}:cU[1].$==13?{$:1,$0:u.Map(a.String,cU[1].$1.get_View())}:(cb.warn("Attribute value hole filled with non-text data",cP),{$:0,$0:""}):{$:0,$0:""});return cT.$==1?[cO,new O({$:1,$0:cR===""?cT.$0:u.Map(function(cW){return cW+cR;},cT.$0),$1:cS})]:[cO+cT.$0+cR,cS];};}(cL))(cM);},cJ,[cB,O.Empty]);return ck(ct,cC[1].$==1?cC[1].$1.$==1?cC[1].$1.$1.$==1?cC[1].$1.$1.$1.$==0?(cD=cC[0],Q.Dynamic(cH,u.Map3(function(cL,cM,cN){return cD+cL+cM+cN;},cC[1].$0,cC[1].$1.$0,cC[1].$1.$1.$0))):(cE=cC[0],Q.Dynamic(cH,u.Map(function(cL){return cE+H.concat("",cL);},u.Sequence(cC[1])))):(cF=cC[0],Q.Dynamic(cH,u.Map2(function(cL,cM){return cF+cL+cM;},cC[1].$0,cC[1].$1.$0))):cC[0]===""?Q.Dynamic(cH,cC[1].$0):(cG=cC[0],Q.Dynamic(cH,u.Map(function(cL){return cG+cL;},cC[1].$0))):_4.Create(cH,cC[0]));}());});return[ca.DeleteEmptyFields({Els:cg,Dirty:true,Holes:cm,Attrs:co,Render:(ch=cp.length==0?null:{$:1,$0:function(ct){q.iter(function(cu){cu(ct);},cp);}},ch?ch.$0:void 0),El:(ci=!w.Equals(cg,null)&&cg.length===1&&(q.get(cg,0)instanceof T&&(q.get(cg,0)instanceof a.Element&&(cj=q.get(cg,0),true)))?{$:1,$0:cj}:null,ci?ci.$0:void 0)},["Render","El"]),_1.TreeReduce(u.Const(),u.Map2Unit,cn)];};B.GlobalHoles=function(){ba.$cctor();return ba.GlobalHoles;};B.TextHoleRE=function(){ba.$cctor();return ba.TextHoleRE;};C.Install=function(ce,cf){var cg;cg=D.Create$1(void 0);C.InstallInto(cg,ce,cf);return cg;};C.InstallInto=function(ce,cf,cg){function ch(ck){return X.Parse(cg,ck);}function ci(){return C.getCurrent(ch,cf);}function cj(ck){if(!w.Equals(ce.Get(),ck))ce.Set(ck);}cj(ci());self.addEventListener("popstate",function(){return cj(ci());},false);self.document.body.addEventListener("click",function(ck){var cl,cm,cn;cl=(cm=(cn=C.findLinkHref(ck.target),cn==null?null:C.hrefToAbsolute(cn.$0)),cm==null?null:ch(bd.FromUrl(cm.$0,null)));return cl==null?null:(cj(cl.$0),ck.preventDefault());},false);u.Sink(function(ck){var cl;if(!w.Equals(ck,ci())){cl=X.Link(cg,ck);self.history.pushState(null,null,cl);}},ce.get_View());};C.getCurrent=function(ce,cf){var cg,ch,ci;cg=self.location;ch=bd.FromUrl(cg.pathname+cg.search,null);ci=ce(ch);return ci==null?((function(cj){return function(ck){return cj("Failed to parse route: "+I.toSafe(ck));};}(function(cj){cb.log(cj);}))(ch.ToLink()),cf):ci.$0;};C.findLinkHref=function(ce){while(true)if(ce.tagName==="A")return bf.ofObj(ce.getAttribute("href"));else if(ce===self.document.body)return null;else ce=ce.parentNode;};C.hrefToAbsolute=function(ce){var cf;return H.StartsWith(ce,"?")?{$:1,$0:C.trimFragment(self.location.pathname+ce)}:H.StartsWith(ce,"#")?null:H.StartsWith(ce,"/")?{$:1,$0:C.trimFragment(ce)}:(new a.RegExp("^[a-zA-Z0-9]:")).test(ce)?null:(cf=self.location.pathname,{$:1,$0:C.trimFragment(bq.string(cf,null,{$:1,$0:cf.lastIndexOf("/")})+ce)});};C.trimFragment=function(ce){var cf;cf=ce.indexOf("#");return cf===-1?ce:bq.string(ce,null,{$:1,$0:cf-1});};D=g.Var$1=ca.Class({},f,D);D.Create$1=function(ce){return new Y.New(false,R.New({$:2,$0:ce,$1:[]}),ce);};D.Create=function(){return new Y.New(false,R.New({$:2,$0:null,$1:[]}),null);};F.YieldVar=function(ce){return F.New(ce.get_Id(),u.Map(function(cf){return{$:0,$0:cf};},ce.get_View()),function(cf){return cf(ce);});};F.WithSubmit=function(ce){var cf;cf=new J.New(ce.view,{$:1,$0:O.Empty});return F.New(_0.Id(),cf.view,function(cg){return(ce.render(cg))(cf);});};F.Run=function(ce,cf){return F.Map(function(cg){ce(cg);return cg;},cf);};F.Render=function(ce,cf){var cg;cg=cf.render(ce);return l.Append(l.EmbedView(u.Map(function(){return l.get_Empty();},cf.view)),cg);};F.Map=function(ce,cf){return F.MapResult(function(cg){return bi.Map(ce,cg);},cf);};F.MapResult=function(ce,cf){return F.New(cf.id,u.Map(ce,cf.view),cf.render);};G.GetFieldValues=function(ce){var cf,cg;cf=[];for(var ch in ce)cf.push(ce[ch]);return cf;};H.concat=function(ce,cf){return q.ofSeq(cf).join(ce);};H.SplitChars=function(ce,cf,cg){return H.Split(ce,new a.RegExp("["+H.RegexEscape(cf.join(""))+"]"),cg);};H.StartsWith=function(ce,cf){return ce.substring(0,cf.length)==cf;};H.Substring=function(ce,cf,cg){return ce.substr(cf,cg);};H.Split=function(ce,cf,cg){return cg===1?q.filter(function(ch){return ch!=="";},H.SplitWith(ce,cf)):H.SplitWith(ce,cf);};H.RegexEscape=function(ce){return ce.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};H.SplitWith=function(ce,cf){return ce.split(cf);};H.IsNullOrEmpty=function(ce){return ce==null||ce=="";};H.Join=function(ce,cf){return cf.join(ce);};H.forall=function(ce,cf){return v.forall(ce,H.protect(cf));};H.protect=function(ce){return ce===null?"":ce;};I.toSafe=function(ce){return ce==null?"":ce;};J=g.Submitter=ca.Class({Trigger:function(){this["var"].Set(null);}},f,J);J.New=ca.Ctor(function(ce,cf){f.New.call(this);this.input=ce;this["var"]=D.Create();this.view=u.SnapshotOn(cf,this["var"].get_View(),this.input);},J);F.New=function(ce,cf,cg){return{id:ce,view:cf,render:cg};};L.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(ce){var cf,cg;cf=cc.random()*16|0;cg=ce=="x"?cf:cf&3|8;return cg.toString(16);});};N=M.List=ca.Class({GetEnumerator:function(){return _9.Get(this);},GetEnumerator0:function(){return _9.Get0(this);}},null,N);O=s.T=ca.Class({GetEnumerator:function(){return new bo.New(this,null,function(ce){var cf;cf=ce.s;return cf.$==0?false:(ce.c=cf.$0,ce.s=cf.$1,true);},void 0);},GetEnumerator0:function(){return _9.Get(this);}},null,O);O.Empty=new O({$:0});P=M.FSharpSet=ca.Class({Add:function(ce){return new P.New$1(Z.Add(ce,this.tree));},Remove:function(ce){return new P.New$1(Z.Remove(ce,this.tree));},GetEnumerator$1:function(){return _9.Get(Z.Enumerate(false,this.tree));},Equals:function(ce){return this.get_Count()===ce.get_Count()&&v.forall2(w.Equals,this,ce);},get_Count:function(){var ce;ce=this.tree;return ce==null?0:ce.Count;},GetHashCode:function(){return -1741749453+w.Hash(q.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(ce){return v.compareWith(w.Compare,this,ce);}},f,P);P.New$1=ca.Ctor(function(ce){f.New.call(this);this.tree=ce;},P);Q.DynamicPred=function(ce,cf,cg){function ch(ci,cj){return cj[0]?ci.setAttribute(ce,cj[1]):ci.removeAttribute(ce);}return _7.Dynamic(u.Map2(function(ci,cj){return[ci,cj];},cf,cg),function(ci){return function(cj){return ch(ci,cj);};});};Q.Handler=function(ce,cf){return _7.Static(function(cg){cg.addEventListener(ce,function(ch){return(cf(cg))(ch);},false);});};Q.OnAfterRender=function(ce){return new _4({$:4,$0:ce});};Q.Value=function(ce){return Q.ValueWith(bX.StringApply(),ce);};Q.Checked=function(ce){return Q.ValueWith(bX.BoolCheckedApply(),ce);};Q.IntValue=function(ce){return Q.ValueWith(bX.IntApplyChecked(),ce);};Q.IntValueUnchecked=function(ce){return Q.ValueWith(bX.IntApplyUnchecked(),ce);};Q.FloatValue=function(ce){return Q.ValueWith(bX.FloatApplyChecked(),ce);};Q.FloatValueUnchecked=function(ce){return Q.ValueWith(bX.FloatApplyUnchecked(),ce);};Q.Dynamic=function(ce,cf){return _7.Dynamic(cf,function(cg){return function(ch){return cg.setAttribute(ce,ch);};});};Q.ValueWith=function(ce,cf){var cg;cg=ce(cf);return _4.Append(_7.Static(cg[0]),Q.DynamicCustom(cg[1],cg[2]));};Q.DynamicCustom=function(ce,cf){return _7.Dynamic(cf,ce);};v.contains=function(ce,cf){var cg,ch;cg=_9.Get(cf);try{ch=false;while(!ch&&cg.MoveNext())ch=w.Equals(cg.Current(),ce);return ch;}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}};v.insufficient=function(){return e.FailWith("The input sequence has an insufficient number of elements.");};q.mapiInPlace=function(ce,cf){var cg,ch;for(cg=0,ch=cf.length-1;cg<=ch;cg++)cf[cg]=ce(cg,cf[cg]);return cf;};q.mapInPlace=function(ce,cf){var cg,ch;for(cg=0,ch=cf.length-1;cg<=ch;cg++)cf[cg]=ce(cf[cg]);};R.Map=function(ce,cf){var cg,ch;cg=cf.s;return cg!=null&&cg.$==0?R.New({$:0,$0:ce(cg.$0)}):(ch=R.New({$:3,$0:[],$1:[]}),(R.When(cf,function(ci){R.MarkDone(ch,cf,ce(ci));},ch),ch));};R.WhenObsoleteRun=function(ce,cf){var cg;cg=ce.s;if(cg==null)cf();else cg!=null&&cg.$==2?cg.$1.push(cf):cg!=null&&cg.$==3?cg.$1.push(cf):void 0;};R.When=function(ce,cf,cg){var ch;ch=ce.s;if(ch==null)R.Obsolete(cg);else ch!=null&&ch.$==2?(R.EnqueueSafe(ch.$1,cg),cf(ch.$0)):ch!=null&&ch.$==3?(ch.$0.push(cf),R.EnqueueSafe(ch.$1,cg)):cf(ch.$0);};R.MarkDone=function(ce,cf,cg){var ch;if(ch=cf.s,ch!=null&&ch.$==0)R.MarkForever(ce,cg);else R.MarkReady(ce,cg);};R.Map2=function(ce,cf,cg){var ch,ci,cj;function ck(cl){var cm,cn,co;if(!(cm=cj.s,cm!=null&&cm.$==0||cm!=null&&cm.$==2)){cn=R.ValueAndForever(cf);co=R.ValueAndForever(cg);if(cn!=null&&cn.$==1)co!=null&&co.$==1?cn.$0[1]&&co.$0[1]?R.MarkForever(cj,ce(cn.$0[0],co.$0[0])):R.MarkReady(cj,ce(cn.$0[0],co.$0[0])):void 0;}}ch=cf.s;ci=cg.s;return ch!=null&&ch.$==0?ci!=null&&ci.$==0?R.New({$:0,$0:ce(ch.$0,ci.$0)}):R.Map2Opt1(ce,ch.$0,cg):ci!=null&&ci.$==0?R.Map2Opt2(ce,ci.$0,cf):(cj=R.New({$:3,$0:[],$1:[]}),(R.When(cf,ck,cj),R.When(cg,ck,cj),cj));};R.WhenRun=function(ce,cf,cg){var ch;ch=ce.s;if(ch==null)cg();else ch!=null&&ch.$==2?(ch.$1.push(cg),cf(ch.$0)):ch!=null&&ch.$==3?(ch.$0.push(cf),ch.$1.push(cg)):cf(ch.$0);};R.Map2Unit=function(ce,cf){var cg,ch,ci;function cj(){var ck,cl,cm;if(!(ck=ci.s,ck!=null&&ck.$==0||ck!=null&&ck.$==2)){cl=R.ValueAndForever(ce);cm=R.ValueAndForever(cf);if(cl!=null&&cl.$==1)cm!=null&&cm.$==1?cl.$0[1]&&cm.$0[1]?R.MarkForever(ci,null):R.MarkReady(ci,null):void 0;}}cg=ce.s;ch=cf.s;return cg!=null&&cg.$==0?ch!=null&&ch.$==0?R.New({$:0,$0:null}):cf:ch!=null&&ch.$==0?ce:(ci=R.New({$:3,$0:[],$1:[]}),(R.When(ce,cj,ci),R.When(cf,cj,ci),ci));};R.Join=function(ce){var cf;cf=R.New({$:3,$0:[],$1:[]});R.When(ce,function(cg){var ch;ch=cg();R.When(ch,function(ci){var cj,ck;if((cj=ch.s,cj!=null&&cj.$==0)&&(ck=ce.s,ck!=null&&ck.$==0))R.MarkForever(cf,ci);else R.MarkReady(cf,ci);},cf);},cf);return cf;};R.EnqueueSafe=function(ce,cf){var cg,ch,ci,cj;ce.push(cf);if(ce.length%20===0){cg=ce.slice(0);bW.Clear(ce);for(ch=0,ci=q.length(cg)-1;ch<=ci;ch++){cj=q.get(cg,ch);if(typeof cj=="object")(function(ck){if(ck.s)ce.push(ck);}(cj));else(function(ck){ce.push(ck);}(cj));}}else void 0;};R.MarkForever=function(ce,cf){var cg,ch,ci,cj;cg=ce.s;if(cg!=null&&cg.$==3){ce.s={$:0,$0:cf};ch=cg.$0;for(ci=0,cj=q.length(ch)-1;ci<=cj;ci++)(q.get(ch,ci))(cf);}else void 0;};R.MarkReady=function(ce,cf){var cg,ch,ci,cj;cg=ce.s;if(cg!=null&&cg.$==3){ce.s={$:2,$0:cf,$1:cg.$1};ch=cg.$0;for(ci=0,cj=q.length(ch)-1;ci<=cj;ci++)(q.get(ch,ci))(cf);}else void 0;};R.Map2Opt1=function(ce,cf,cg){return R.Map(function(ch){return ce(cf,ch);},cg);};R.Map2Opt2=function(ce,cf,cg){return R.Map(function(ch){return ce(ch,cf);},cg);};R.ValueAndForever=function(ce){var cf;cf=ce.s;return cf!=null&&cf.$==0?{$:1,$0:[cf.$0,true]}:cf!=null&&cf.$==2?{$:1,$0:[cf.$0,false]}:null;};R.SnapshotOn=function(ce,cf){var cg;function ch(ci){var cj,ck,cl;if(!(cj=cg.s,cj!=null&&cj.$==0||cj!=null&&cj.$==2)){ck=R.ValueAndForever(ce);cl=R.ValueAndForever(cf);if(ck!=null&&ck.$==1)cl!=null&&cl.$==1?ck.$0[1]||cl.$0[1]?R.MarkForever(cg,cl.$0[0]):R.MarkReady(cg,cl.$0[0]):void 0;}}cg=R.New({$:3,$0:[],$1:[]});R.When(ce,ch,cg);R.WhenReady(cf,ch);return cg;};R.WhenObsolete=function(ce,cf){var cg;cg=ce.s;if(cg==null)R.Obsolete(cf);else cg!=null&&cg.$==2?R.EnqueueSafe(cg.$1,cf):cg!=null&&cg.$==3?R.EnqueueSafe(cg.$1,cf):void 0;};R.WhenReady=function(ce,cf){var cg,ch;ch=ce.s;switch(ch!=null&&ch.$==2?(cg=ch.$0,0):ch==null?1:ch!=null&&ch.$==3?2:(cg=ch.$0,0)){case 0:cf(cg);break;case 1:null;break;case 2:ch.$0.push(cf);break;}};R.Map3=function(ce,cf,cg,ch){var ci,cj,ck,cl;function cm(cn){var co,cp,cq,cr;if(!(co=cl.s,co!=null&&co.$==0||co!=null&&co.$==2)){cp=R.ValueAndForever(cf);cq=R.ValueAndForever(cg);cr=R.ValueAndForever(ch);if(cp!=null&&cp.$==1)cq!=null&&cq.$==1?cr!=null&&cr.$==1?cp.$0[1]&&cq.$0[1]&&cr.$0[1]?R.MarkForever(cl,ce(cp.$0[0],cq.$0[0],cr.$0[0])):R.MarkReady(cl,ce(cp.$0[0],cq.$0[0],cr.$0[0])):void 0:void 0;}}ci=cf.s;cj=cg.s;ck=ch.s;return ci!=null&&ci.$==0?cj!=null&&cj.$==0?ck!=null&&ck.$==0?R.New({$:0,$0:ce(ci.$0,cj.$0,ck.$0)}):R.Map3Opt1(ce,ci.$0,cj.$0,ch):ck!=null&&ck.$==0?R.Map3Opt2(ce,ci.$0,ck.$0,cg):R.Map3Opt3(ce,ci.$0,cg,ch):cj!=null&&cj.$==0?ck!=null&&ck.$==0?R.Map3Opt4(ce,cj.$0,ck.$0,cf):R.Map3Opt5(ce,cj.$0,cf,ch):ck!=null&&ck.$==0?R.Map3Opt6(ce,ck.$0,cf,cg):(cl=R.New({$:3,$0:[],$1:[]}),(R.When(cf,cm,cl),R.When(cg,cm,cl),R.When(ch,cm,cl),cl));};R.Sequence=function(ce){var cf,cg,ch;function ci(cj){var ck;if(ch[0]===0){ck=q.map(function(cl){var cm;cm=cl.s;return cm!=null&&cm.$==0?cm.$0:cm!=null&&cm.$==2?cm.$0:e.FailWith("value not found by View.Sequence");},cf);if(q.forall(function(cl){var cm;cm=cl.s;return cm!=null&&cm.$==0;},cf))R.MarkForever(cg,ck);else R.MarkReady(cg,ck);}else ch[0]--;}cf=q.ofSeq(ce);return cf.length==0?R.New({$:0,$0:[]}):(cg=R.New({$:3,$0:[],$1:[]}),(ch=[q.length(cf)-1],(q.iter(function(cj){R.When(cj,ci,cg);},cf),cg)));};R.Copy=function(ce){var cf,cg,ch;cf=ce.s;return cf==null?ce:cf!=null&&cf.$==2?(cg=R.New({$:2,$0:cf.$0,$1:[]}),(R.WhenObsolete(ce,cg),cg)):cf!=null&&cf.$==3?(ch=R.New({$:3,$0:[],$1:[]}),(R.When(ce,function(ci){R.MarkDone(ch,ce,ci);},ch),ch)):ce;};R.Map3Opt1=function(ce,cf,cg,ch){return R.Map(function(ci){return ce(cf,cg,ci);},ch);};R.Map3Opt2=function(ce,cf,cg,ch){return R.Map(function(ci){return ce(cf,ci,cg);},ch);};R.Map3Opt3=function(ce,cf,cg,ch){return R.Map2(function(ci,cj){return ce(cf,ci,cj);},cg,ch);};R.Map3Opt4=function(ce,cf,cg,ch){return R.Map(function(ci){return ce(ci,cf,cg);},ch);};R.Map3Opt5=function(ce,cf,cg,ch){return R.Map2(function(ci,cj){return ce(ci,cf,cj);},cg,ch);};R.Map3Opt6=function(ce,cf,cg,ch){return R.Map2(function(ci,cj){return ce(ci,cj,cf);},cg,ch);};U=M.Dictionary=ca.Class({set_Item:function(ce,cf){this.set(ce,cf);},ContainsKey:function(ce){var cf,cg;cf=this;cg=this.data[this.hash(ce)];return cg==null?false:q.exists(function(ch){return cf.equals.apply(null,[(e.KeyValue(ch))[0],ce]);},cg);},TryGetValue:function(ce,cf){var cg,ch,ci;cg=this;ch=this.data[this.hash(ce)];return ch==null?false:(ci=q.tryPick(function(cj){var ck;ck=e.KeyValue(cj);return cg.equals.apply(null,[ck[0],ce])?{$:1,$0:ck[1]}:null;},ch),ci!=null&&ci.$==1&&(cf.set(ci.$0),true));},Remove:function(ce){return this.remove(ce);},get_Keys:function(){return new br.New(this);},set:function(ce,cf){var cg,ch,ci,cj;cg=this;ch=this.hash(ce);ci=this.data[ch];if(ci==null){this.count=this.count+1;this.data[ch]=new a.Array({K:ce,V:cf});}else{cj=q.tryFindIndex(function(ck){return cg.equals.apply(null,[(e.KeyValue(ck))[0],ce]);},ci);cj==null?(this.count=this.count+1,ci.push({K:ce,V:cf})):ci[cj.$0]={K:ce,V:cf};}},remove:function(ce){var cf,cg,ch,ci;cf=this;cg=this.hash(ce);ch=this.data[cg];return ch==null?false:(ci=q.filter(function(cj){return!cf.equals.apply(null,[(e.KeyValue(cj))[0],ce]);},ch),q.length(ci)<ch.length&&(this.count=this.count-1,this.data[cg]=ci,true));},get_Item:function(ce){return this.get(ce);},get_Values:function(){return new bN.New(this);},get:function(ce){var cf,cg;cf=this;cg=this.data[this.hash(ce)];return cg==null?bn.notPresent():q.pick(function(ch){var ci;ci=e.KeyValue(ch);return cf.equals.apply(null,[ci[0],ce])?{$:1,$0:ci[1]}:null;},cg);},GetEnumerator:function(){return _9.Get0(this);},GetEnumerator0:function(){return _9.Get0(q.concat(G.GetFieldValues(this.data)));}},f,U);U.New$5=ca.Ctor(function(){U.New$6.call(this,[],w.Equals,w.Hash);},U);U.New$6=ca.Ctor(function(ce,cf,cg){var ch,ci;f.New.call(this);this.equals=cf;this.hash=cg;this.count=0;this.data=[];ch=_9.Get(ce);try{while(ch.MoveNext()){ci=ch.Current();this.set(ci.K,ci.V);}}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}},U);W.JSUnion=function(ce,cf){var cg;function ch(cl){var cm;function cn(co){return co!=null&&co.$==1&&w.Equals(cl,co.$0);}cm=v.tryFindIndex(function(co){return cn(co[0]);},cf);return cm!=null&&cm.$==1?cm.$0:cl.$;}function ci(cl,cm){return q.init(q.length((q.get(cf,cl))[2]),function(cn){return cm["$"+a.String(cn)];});}function cj(cl,cm){var cn,co,cp;cn=ce==null?{}:new ce();co=q.get(cf,cl);return(cp=co[0],cp!=null&&cp.$==1)?co[0].$0:(cn.$=cl,v.iteri(function(cq,cr){cn["$"+a.String(cq)]=cr;},cm),cn);}function ck(cl,cm){var cn;function co(cp,cq){return[cl,cp,cq,cn];}cn=cm[2];return v.map(function(cp){return co(cp[0],cp[1]);},cm[1]);}cg=q.ofSeq(v.collect(function(cl){return ck(cl[0],cl[1]);},v.indexed(cf)));return bc.New$1(function(cl){function cm(cn,co,cp,cq){var cr,cs,ct;function cu(cv){return function(cw){return function(cx){var cy;function cz(cA,cB){return((cu(cy))(cA))(new O({$:1,$0:cB,$1:cx}));}return cv.$==1?(cy=cv.$1,v.collect(function(cA){return cz(cA[0],cA[1]);},cv.$0.Parse(cw))):[[cw,cj(cn,q.ofList(s.rev(cx)))]];};};}return W.isCorrectMethod(co,cl.Method)?(cr=be.startsWith(s.ofArray(cp),cl.Segments),cr==null?[]:(cs=cr.$0,(ct=s.ofArray(cq),ct.$==0?[[bd.New(cs,cl.QueryArgs,cl.FormData,cl.Method,cl.Body),cj(cn,[])]]:((cu(ct))(bd.New(cs,cl.QueryArgs,cl.FormData,cl.Method,cl.Body)))(O.Empty)))):[];}return v.collect(function(cn){return cm(cn[0],cn[1],cn[2],cn[3]);},cg);},function(cl){var cm,cn,co,cp,cq,cr;function cs(ct,cu){return cu.Write(ct);}cm=ch(cl);cn=q.get(cf,cm);co=cn[2];cp=q.get(cn[1],0);cq=[bd.Segment(s.ofArray(cp[1]),cp[0])];return co.length==0?{$:1,$0:cq}:(cr=(((ca.Curried3(q.map2))(cs))(ci(cm,cl)))(co),q.forall(function(ct){return ct!=null;},cr)?{$:1,$0:v.append(cq,v.collect(function(ct){return ct.$0;},cr))}:null);});};W.isCorrectMethod=function(ce,cf){return cf!=null&&cf.$==1?ce!=null&&ce.$==1?w.Equals(cf.$0,ce.$0):true:!(ce!=null&&ce.$==1);};X.Parse=function(ce,cf){function cg(ch,ci){return ch.Segments.$==0?{$:1,$0:ci}:null;}return v.tryPick(function(ch){return cg(ch[0],ch[1]);},ce.Parse(cf));};X.Link=function(ce,cf){var cg;cg=X.Write(ce,cf);return cg==null?"":cg.$0.ToLink();};X.Write=function(ce,cf){var cg;cg=ce.Write(cf);return cg==null?null:{$:1,$0:bd.Combine(cg.$0)};};Y=g.ConcreteVar=ca.Class({get_View:function(){return this.view;},Update:function(ce){this.Set(ce(this.Get()));},Set:function(ce){if(this.isConst)(function(cf){return cf("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cf){cb.log(cf);}));else{R.Obsolete(this.snap);this.current=ce;this.snap=R.New({$:2,$0:ce,$1:[]});}},get_Id:function(){return"uinref"+a.String(this.id);},Get:function(){return this.current;},UpdateMaybe:function(ce){var cf;cf=ce(this.Get());if(cf!=null&&cf.$==1)this.Set(cf.$0);}},h,Y);Y.New=ca.Ctor(function(ce,cf,cg){var ch;ch=this;h.New.call(this);this.isConst=ce;this.current=cg;this.snap=cf;this.view=function(){return ch.snap;};this.id=bh.Int();},Y);Z.Add=function(ce,cf){return Z.Put(function(cg,ch){return ch;},ce,cf);};Z.Remove=function(ce,cf){var cg,ch,ci,cj;cg=Z.Lookup(ce,cf);ch=cg[0];ci=cg[1];return ch==null?cf:ch.Right==null?Z.Rebuild(ci,ch.Left):ch.Left==null?Z.Rebuild(ci,ch.Right):Z.Rebuild(ci,(cj=q.ofSeq(v.append(Z.Enumerate(false,ch.Left),Z.Enumerate(false,ch.Right))),Z.Build(cj,0,cj.length-1)));};Z.Put=function(ce,cf,cg){var ch,ci;ch=Z.Lookup(cf,cg);ci=ch[0];return ci==null?Z.Rebuild(ch[1],Z.Branch(cf,null,null)):Z.Rebuild(ch[1],Z.Branch(ce(ci.Node,cf),ci.Left,ci.Right));};Z.Lookup=function(ce,cf){var cg,ch,ci,cj;cg=[];ch=cf;ci=true;while(ci)if(ch==null)ci=false;else{cj=w.Compare(ce,ch.Node);if(cj===0)ci=false;else cj===1?(cg.unshift([true,ch.Node,ch.Left]),ch=ch.Right):(cg.unshift([false,ch.Node,ch.Right]),ch=ch.Left);}return[ch,cg];};Z.Rebuild=function(ce,cf){var cg,ci,cj,ck,cl,cm,cn,co,cp,cq;function ch(cr){return cr==null?0:cr.Height;}cg=cf;for(ci=0,cj=q.length(ce)-1;ci<=cj;ci++){cg=(ck=q.get(ce,ci),ck[0]?(cl=ck[1],(cm=ck[2],ch(cg)>ch(cm)+1?ch(cg.Left)===ch(cg.Right)+1?(cn=cg.Left,Z.Branch(cn.Node,Z.Branch(cl,cm,cn.Left),Z.Branch(cg.Node,cn.Right,cg.Right))):Z.Branch(cg.Node,Z.Branch(cl,cm,cg.Left),cg.Right):Z.Branch(cl,cm,cg))):(co=ck[1],(cp=ck[2],ch(cg)>ch(cp)+1?ch(cg.Right)===ch(cg.Left)+1?(cq=cg.Right,Z.Branch(cq.Node,Z.Branch(cg.Node,cg.Left,cq.Left),Z.Branch(co,cq.Right,cp))):Z.Branch(cg.Node,cg.Left,Z.Branch(co,cg.Right,cp)):Z.Branch(co,cg,cp))));}return cg;};Z.Branch=function(ce,cf,cg){var ch,ci;return bl.New(ce,cf,cg,1+(ch=cf==null?0:cf.Height,(ci=cg==null?0:cg.Height,w.Compare(ch,ci)===1?ch:ci)),1+(cf==null?0:cf.Count)+(cg==null?0:cg.Count));};Z.Enumerate=function(ce,cf){function cg(ch,ci){var cj;while(true)if(ch==null)return ci.$==1?{$:1,$0:[ci.$0[0],[ci.$0[1],ci.$1]]}:null;else if(ce){cj=ch;ch=cj.Right;ci=new O({$:1,$0:[cj.Node,cj.Left],$1:ci});}else{cj=ch;ch=cj.Left;ci=new O({$:1,$0:[cj.Node,cj.Right],$1:ci});}}return v.unfold(function(ch){return cg(ch[0],ch[1]);},[cf,O.Empty]);};Z.Build=function(ce,cf,cg){var ch,ci,cj;return cg-cf+1<=0?null:(ch=(cf+cg)/2>>0,(ci=Z.Build(ce,cf,ch-1),(cj=Z.Build(ce,ch+1,cg),Z.Branch(q.get(ce,ch),ci,cj))));};Z.OfSeq=function(ce){var cf;cf=q.ofSeq(v.distinct(ce));q.sortInPlace(cf);return Z.Build(cf,0,cf.length-1);};_0.Id=function(){(_0.lastId())[0]++;return"Form"+a.String((_0.lastId())[0]);};_0.lastId=function(){bz.$cctor();return bz.lastId;};_1.ofSeqNonCopying=function(ce){var cf,cg;if(ce instanceof a.Array)return ce;else if(ce instanceof O)return q.ofList(ce);else if(ce===null)return[];else{cf=[];cg=_9.Get(ce);try{while(cg.MoveNext())cf.push(cg.Current());return cf;}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}}};_1.TreeReduce=function(ce,cf,cg){var ch;function ci(cj){return function(ck){var cl,cm;return ck<=0?ce:ck===1&&(cj>=0&&cj<ch)?q.get(cg,cj):(cm=ck/2>>0,cf((ci(cj))(cm),(ci(cj+cm))(ck-cm)));};}ch=q.length(cg);return(ci(0))(ch);};_1.MapTreeReduce=function(ce,cf,cg,ch){var ci;function cj(ck){return function(cl){var cm,cn;return cl<=0?cf:cl===1&&(ck>=0&&ck<ci)?ce(q.get(ch,ck)):(cn=cl/2>>0,cg((cj(ck))(cn),(cj(ck+cn))(cl-cn)));};}ci=q.length(ch);return(cj(0))(ci);};_2.CreateEmbedNode=function(){return{Current:null,Dirty:false};};_2.UpdateEmbedNode=function(ce,cf){ce.Current=cf;ce.Dirty=true;};_2.LinkElement=function(ce,cf){_2.InsertDoc(ce,cf,null);};_2.InsertDoc=function(ce,cf,cg){var ch,ci,cj;while(true)if(cf!=null&&cf.$==1)return _2.InsertNode(ce,cf.$0.El,cg);else if(cf!=null&&cf.$==2){ch=cf.$0;ch.Dirty=false;cf=ch.Current;}else if(cf==null)return cg;else if(cf!=null&&cf.$==4)return _2.InsertNode(ce,cf.$0.Text,cg);else if(cf!=null&&cf.$==5)return _2.InsertNode(ce,cf.$0,cg);else if(cf!=null&&cf.$==6)return q.foldBack(function(ck,cl){return(((ca.Curried3(function(cm,cn,co){return cn==null||cn.constructor===_3?_2.InsertDoc(cm,cn,co):_2.InsertNode(cm,cn,co);}))(ce))(ck))(cl);},cf.$0.Els,cg);else{ci=cf.$1;cj=cf.$0;cf=cj;cg=_2.InsertDoc(ce,ci,cg);}};_2.CreateRunState=function(ce,cf){return bE.New(bF.get_Empty(),_2.CreateElemNode(ce,_7.EmptyAttr(),cf));};_2.PerformAnimatedUpdate=function(ce,cf,cg){var ch;return bs.get_UseAnimations()?(ch=null,bx.Delay(function(){var ci,cj,ck;ci=bF.FindAll(cg);cj=_2.ComputeChangeAnim(cf,ci);ck=_2.ComputeEnterAnim(cf,ci);return bx.Bind(bs.Play(bs.Append(cj,_2.ComputeExitAnim(cf,ci))),function(){return bx.Bind(_2.SyncElemNodesNextFrame(ce,cf),function(){return bx.Bind(bs.Play(ck),function(){cf.PreviousNodes=ci;return bx.Return(null);});});});})):_2.SyncElemNodesNextFrame(ce,cf);};_2.PerformSyncUpdate=function(ce,cf,cg){var ch;ch=bF.FindAll(cg);_2.SyncElemNode(ce,cf.Top);cf.PreviousNodes=ch;};_2.InsertNode=function(ce,cf,cg){_8.InsertAt(ce,cg,cf);return cf;};_2.CreateElemNode=function(ce,cf,cg){var ch;_2.LinkElement(ce,cg);ch=_7.Insert(ce,cf);return bj.New(ch,cg,null,ce,bh.Int(),ca.GetOptional(ch.OnAfterRender));};_2.SyncElemNodesNextFrame=function(ce,cf){function cg(ch){a.requestAnimationFrame(function(){_2.SyncElemNode(ce,cf.Top);ch();});}return bt.BatchUpdatesEnabled()?bx.FromContinuations(function(ch,ci,cj){return cg.apply(null,[ch,ci,cj]);}):(_2.SyncElemNode(ce,cf.Top),bx.Return(null));};_2.ComputeExitAnim=function(ce,cf){return bs.Concat(q.map(function(cg){return _7.GetExitAnim(cg.Attr);},bF.ToArray(bF.Except(cf,bF.Filter(function(cg){return _7.HasExitAnim(cg.Attr);},ce.PreviousNodes)))));};_2.ComputeEnterAnim=function(ce,cf){return bs.Concat(q.map(function(cg){return _7.GetEnterAnim(cg.Attr);},bF.ToArray(bF.Except(ce.PreviousNodes,bF.Filter(function(cg){return _7.HasEnterAnim(cg.Attr);},cf)))));};_2.ComputeChangeAnim=function(ce,cf){var cg;function ch(ci){return _7.HasChangeAnim(ci.Attr);}cg=function(ci){return bF.Filter(ch,ci);};return bs.Concat(q.map(function(ci){return _7.GetChangeAnim(ci.Attr);},bF.ToArray(bF.Intersect(cg(ce.PreviousNodes),cg(cf)))));};_2.SyncElemNode=function(ce,cf){!ce?_2.SyncElement(cf):void 0;_2.Sync(cf.Children);_2.AfterRender(cf);};_2.InsertBeforeDelim=function(ce,cf){var cg,ch;cg=ce.parentNode;ch=self.document.createTextNode("");cg.insertBefore(ch,ce);_2.LinkPrevElement(ce,cf);return ch;};_2.SyncElement=function(ce){function cf(cg){function ch(ci){var cj,ck,cl,cm;while(true){if(ci!=null&&ci.$==0){ck=ci.$1;cl=ci.$0;if(ch(cl))return true;else ci=ck;}else if(ci!=null&&ci.$==2){cm=ci.$0;if(cm.Dirty)return true;else ci=cm.Current;}else return ci!=null&&ci.$==6&&(cj=ci.$0,cj.Dirty||q.exists(cf,cj.Holes));}}return ch(cg.Children);}_7.Sync(ce.El,ce.Attr);if(cf(ce))_2.DoSyncElement(ce);};_2.Sync=function(ce){var cf,cg,ch,ci,cj;while(true){if(ce!=null&&ce.$==1)return _2.SyncElemNode(false,ce.$0);else if(ce!=null&&ce.$==2){ch=ce.$0;ce=ch.Current;}else if(ce==null)return null;else if(ce!=null&&ce.$==5)return null;else if(ce!=null&&ce.$==4){cf=ce.$0;return cf.Dirty?(cf.Text.nodeValue=cf.Value,cf.Dirty=false):null;}else if(ce!=null&&ce.$==6){cg=ce.$0;q.iter(function(ck){return function(cl){_2.SyncElemNode(ck,cl);};}(false),cg.Holes);q.iter(function(ck){_7.Sync(ck[0],ck[1]);},cg.Attrs);return _2.AfterRender(cg);}else{ci=ce.$1;cj=ce.$0;_2.Sync(cj);ce=ci;}}};_2.AfterRender=function(ce){var cf;cf=ca.GetOptional(ce.Render);if(cf!=null&&cf.$==1){cf.$0(ce.El);ca.SetOptional(ce,"Render",null);}};_2.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};_2.UpdateTextNode=function(ce,cf){ce.Value=cf;ce.Dirty=true;};_2.LinkPrevElement=function(ce,cf){_2.InsertDoc(ce.parentNode,cf,ce);};_2.DoSyncElement=function(ce){var cf,cg,ch;function ci(cj,ck){var cl,cm,cn,co;while(true){if(cj!=null&&cj.$==1)return cj.$0.El;else if(cj!=null&&cj.$==2){cm=cj.$0;if(cm.Dirty){cm.Dirty=false;return _2.InsertDoc(cf,cm.Current,ck);}else cj=cm.Current;}else if(cj==null)return ck;else if(cj!=null&&cj.$==4)return cj.$0.Text;else if(cj!=null&&cj.$==5)return cj.$0;else if(cj!=null&&cj.$==6){cl=cj.$0;cl.Dirty?cl.Dirty=false:void 0;return q.foldBack(function(cp,cq){return cp==null||cp.constructor===_3?ci(cp,cq):cp;},cl.Els,ck);}else{cn=cj.$1;co=cj.$0;cj=co;ck=ci(cn,ck);}}}cf=ce.El;b6.Iter((cg=ce.El,function(cj){_8.RemoveNode(cg,cj);}),b6.Except(b6.DocChildren(ce),b6.Children(ce.El,ca.GetOptional(ce.Delimiters))));ci(ce.Children,(ch=ca.GetOptional(ce.Delimiters),ch!=null&&ch.$==1?ch.$0[1]:null));};_4=g.AttrProxy=ca.Class({},null,_4);_4.Concat=function(ce){var cf;cf=_1.ofSeqNonCopying(ce);return _1.TreeReduce(_7.EmptyAttr(),_4.Append,cf);};_4.Append=function(ce,cf){return _7.AppendTree(ce,cf);};_4.Handler=function(ce,cf){return _4.HandlerImpl(ce,cf);};_4.Create=function(ce,cf){return _7.Static(function(cg){cg.setAttribute(ce,cf);});};_4.HandlerImpl=function(ce,cf){return _7.Static(function(cg){cg.addEventListener(ce,function(ch){return(cf(cg))(ch);},false);});};_5=g.CheckedInput=ca.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,_5);_6.TryParseInt32=function(ce,cf){return _6.TryParse(ce,-2147483648,2147483647,cf);};_7.Dynamic=function(ce,cf){return new _4({$:1,$0:new bm.New(ce,cf)});};_7.Static=function(ce){return new _4({$:3,$0:ce});};_7.Insert=function(ce,cf){var cg,ch,ci;function cj(ck){var cl,cm;while(true)if(!(ck===null)){if(ck!=null&&ck.$==1)return cg.push(ck.$0);else if(ck!=null&&ck.$==2){cl=ck.$1;cm=ck.$0;cj(cm);ck=cl;}else return ck!=null&&ck.$==3?ck.$0(ce):ck!=null&&ck.$==4?ch.push(ck.$0):null;}else return null;}cg=[];ch=[];cj(cf);ci=cg.slice(0);return bB.New(ce,_7.Flags(cf),ci,ch.length===0?null:{$:1,$0:function(ck){v.iter(function(cl){cl(ck);},ch);}});};_7.Updates=function(ce){return _1.MapTreeReduce(function(cf){return cf.NChanged();},u.Const(),u.Map2Unit,ce.DynNodes);};_7.Empty=function(ce){return bB.New(ce,0,[],null);};_7.EmptyAttr=function(){bY.$cctor();return bY.EmptyAttr;};_7.HasExitAnim=function(ce){var cf;cf=2;return(ce.DynFlags&cf)===cf;};_7.GetExitAnim=function(ce){return _7.GetAnim(ce,function(cf,cg){return cf.NGetExitAnim(cg);});};_7.HasEnterAnim=function(ce){var cf;cf=1;return(ce.DynFlags&cf)===cf;};_7.GetEnterAnim=function(ce){return _7.GetAnim(ce,function(cf,cg){return cf.NGetEnterAnim(cg);});};_7.HasChangeAnim=function(ce){var cf;cf=4;return(ce.DynFlags&cf)===cf;};_7.GetChangeAnim=function(ce){return _7.GetAnim(ce,function(cf,cg){return cf.NGetChangeAnim(cg);});};_7.AppendTree=function(ce,cf){var cg;return ce===null?cf:cf===null?ce:(cg=new _4({$:2,$0:ce,$1:cf}),(_7.SetFlags(cg,_7.Flags(ce)|_7.Flags(cf)),cg));};_7.Flags=function(ce){return ce!==null&&ce.hasOwnProperty("flags")?ce.flags:0;};_7.GetAnim=function(ce,cf){return bs.Concat(q.map(function(cg){return cf(cg,ce.DynElem);},ce.DynNodes));};_7.Sync=function(ce,cf){q.iter(function(cg){cg.NSync(ce);},cf.DynNodes);};_7.SetFlags=function(ce,cf){ce.flags=cf;};_8.ParseHTMLIntoFakeRoot=function(ce){var cf,cg,ch,ci,cj;function ck(cl,cm){var cn;while(true)if(cm===0)return cl;else{cn=cm;cl=cl.lastChild;cm=cn-1;}}cf=self.document.createElement("div");return!_8.rhtml().test(ce)?(cf.appendChild(self.document.createTextNode(ce)),cf):(cg=(ch=_8.rtagName().exec(ce),w.Equals(ch,null)?"":q.get(ch,1).toLowerCase()),(ci=(cj=(_8.wrapMap())[cg],cj?cj:_8.defaultWrap()),(cf.innerHTML=ci[1]+ce.replace(_8.rxhtmlTag(),"<$1></$2>")+ci[2],ck(cf,ci[0]))));};_8.rhtml=function(){bO.$cctor();return bO.rhtml;};_8.wrapMap=function(){bO.$cctor();return bO.wrapMap;};_8.defaultWrap=function(){bO.$cctor();return bO.defaultWrap;};_8.rxhtmlTag=function(){bO.$cctor();return bO.rxhtmlTag;};_8.rtagName=function(){bO.$cctor();return bO.rtagName;};_8.IterSelector=function(ce,cf,cg){var ch,ci,cj;ch=ce.querySelectorAll(cf);for(ci=0,cj=ch.length-1;ci<=cj;ci++)cg(ch[ci]);};_8.ChildrenArray=function(ce){var cf,cg,ch;cf=[];for(cg=0,ch=ce.childNodes.length-1;cg<=ch;cg++)cf.push(ce.childNodes[cg]);return cf;};_8.InsertAt=function(ce,cf,cg){var ch;if(!(cg.parentNode===ce&&cf===(ch=cg.nextSibling,w.Equals(ch,null)?null:ch)))ce.insertBefore(cg,cf);};_8.RemoveNode=function(ce,cf){if(cf.parentNode===ce)ce.removeChild(cf);};_9.Get=function(ce){return ce instanceof a.Array?_9.ArrayEnumerator(ce):w.Equals(typeof ce,"string")?_9.StringEnumerator(ce):ce.GetEnumerator();};_9.ArrayEnumerator=function(ce){return new bo.New(0,null,function(cf){var cg;cg=cf.s;return cg<q.length(ce)&&(cf.c=q.get(ce,cg),cf.s=cg+1,true);},void 0);};_9.StringEnumerator=function(ce){return new bo.New(0,null,function(cf){var cg;cg=cf.s;return cg<ce.length&&(cf.c=ce[cg],cf.s=cg+1,true);},void 0);};_9.Get0=function(ce){return ce instanceof a.Array?_9.ArrayEnumerator(ce):w.Equals(typeof ce,"string")?_9.StringEnumerator(ce):"GetEnumerator0"in ce?ce.GetEnumerator0():ce.GetEnumerator();};_=M.HashSet=ca.Class({Add:function(ce){return this.add(ce);},Contains:function(ce){var cf;cf=this.data[this.hash(ce)];return cf==null?false:this.arrContains(ce,cf);},add:function(ce){var cf,cg;cf=this.hash(ce);cg=this.data[cf];return cg==null?(this.data[cf]=[ce],this.count=this.count+1,true):this.arrContains(ce,cg)?false:(cg.push(ce),this.count=this.count+1,true);},arrContains:function(ce,cf){var cg,ch,ci,cj;cg=true;ch=0;cj=cf.length;while(cg&&ch<cj)if(this.equals.apply(null,[cf[ch],ce]))cg=false;else ch=ch+1;return!cg;},ExceptWith:function(ce){var cf;cf=_9.Get(ce);try{while(cf.MoveNext())this.Remove(cf.Current());}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(ce){var cf,cg,ch,ci;cf=0;cg=bR.concat(this.data);for(ch=0,ci=cg.length-1;ch<=ci;ch++)q.set(ce,ch,cg[ch]);},IntersectWith:function(ce){var cf,cg,ch,ci,cj;cf=new _.New$4(ce,this.equals,this.hash);cg=bR.concat(this.data);for(ch=0,ci=cg.length-1;ch<=ci;ch++){cj=cg[ch];if(!cf.Contains(cj))this.Remove(cj);}},Remove:function(ce){var cf;cf=this.data[this.hash(ce)];return cf==null?false:this.arrRemove(ce,cf)&&(this.count=this.count-1,true);},arrRemove:function(ce,cf){var cg,ch,ci,cj;cg=true;ch=0;cj=cf.length;while(cg&&ch<cj)if(this.equals.apply(null,[cf[ch],ce])){cf.splice.apply(cf,[ch,1]);cg=false;}else ch=ch+1;return!cg;},GetEnumerator:function(){return _9.Get(bR.concat(this.data));},GetEnumerator0:function(){return _9.Get(bR.concat(this.data));}},f,_);_.New$3=ca.Ctor(function(){_.New$4.call(this,[],w.Equals,w.Hash);},_);_.New$4=ca.Ctor(function(ce,cf,cg){var ch;f.New.call(this);this.equals=cf;this.hash=cg;this.data=[];this.count=0;ch=_9.Get(ce);try{while(ch.MoveNext())this.add(ch.Current());}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}},_);_.New$2=ca.Ctor(function(ce){_.New$4.call(this,ce,w.Equals,w.Hash);},_);q.choose=function(ce,cf){var cg,ch,ci,cj;cg=[];for(ch=0,ci=cf.length-1;ch<=ci;ch++){cj=ce(cf[ch]);if(cj==null);else cg.push(cj.$0);}return cg;};q.ofList=function(ce){var cf,cg;cg=[];cf=ce;while(!(cf.$==0)){cg.push(s.head(cf));cf=s.tail(cf);}return cg;};q.map2=function(ce,cf,cg){var ch,ci,cj;q.checkLength(cf,cg);ch=new a.Array(cg.length);for(ci=0,cj=cg.length-1;ci<=cj;ci++)ch[ci]=ce(cf[ci],cg[ci]);return ch;};q.forall=function(ce,cf){var cg,ch,ci,cj;cg=true;ch=0;cj=q.length(cf);while(cg&&ch<cj)if(ce(cf[ch]))ch=ch+1;else cg=false;return cg;};q.ofSeq=function(ce){var cf,cg;if(ce instanceof a.Array)return ce.slice();else if(ce instanceof O)return q.ofList(ce);else{cf=[];cg=_9.Get(ce);try{while(cg.MoveNext())cf.push(cg.Current());return cf;}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}}};q.init=function(ce,cf){var cg,ch,ci;if(ce<0)e.FailWith("Negative size given.");else null;cg=new a.Array(ce);for(ch=0,ci=ce-1;ch<=ci;ch++)cg[ch]=cf(ch);return cg;};q.exists=function(ce,cf){var cg,ch,ci,cj;cg=false;ch=0;cj=q.length(cf);while(!cg&&ch<cj)if(ce(cf[ch]))cg=true;else ch=ch+1;return cg;};q.tryPick=function(ce,cf){var cg,ch,ci;cg=null;ch=0;while(ch<cf.length&&cg==null){ci=ce(cf[ch]);if(ci!=null&&ci.$==1)cg=ci;ch=ch+1;}return cg;};q.tryFindIndex=function(ce,cf){var cg,ch;cg=null;ch=0;while(ch<cf.length&&cg==null){ce(cf[ch])?cg={$:1,$0:ch}:void 0;ch=ch+1;}return cg;};q.checkLength=function(ce,cf){if(ce.length!==cf.length)e.FailWith("The arrays have different lengths.");};q.filter=function(ce,cf){var cg,ch,ci;cg=[];for(ch=0,ci=cf.length-1;ch<=ci;ch++)if(ce(cf[ch]))cg.push(cf[ch]);return cg;};q.map=function(ce,cf){var cg,ch,ci;cg=new a.Array(cf.length);for(ch=0,ci=cf.length-1;ch<=ci;ch++)cg[ch]=ce(cf[ch]);return cg;};q.iter=function(ce,cf){var cg,ch;for(cg=0,ch=cf.length-1;cg<=ch;cg++)ce(cf[cg]);};q.foldBack=function(ce,cf,cg){var ch,ci,cj,ck,cl;ch=cg;cj=cf.length;for(ck=1,cl=cj;ck<=cl;ck++)ch=ce(cf[cj-ck],ch);return ch;};q.concat=function(ce){return a.Array.prototype.concat.apply([],q.ofSeq(ce));};q.pick=function(ce,cf){var cg;cg=q.tryPick(ce,cf);return cg==null?e.FailWith("KeyNotFoundException"):cg.$0;};q.sortInPlace=function(ce){q.mapInPlace(function(cf){return cf[0];},q.mapiInPlace(function(cf,cg){return[cg,cf];},ce).sort(w.Compare));};q.create=function(ce,cf){var cg,ch,ci;cg=new a.Array(ce);for(ch=0,ci=ce-1;ch<=ci;ch++)cg[ch]=cf;return cg;};$.$cctor=function(){$.$cctor=a.ignore;$.initialized=new U.New$5();};$=o.TemplateInitializer=ca.Class({},f,$);$.GetOrAddHoleFor=function(ce,cf,cg){var ch,ci,cj,ck;$.$cctor();ch=$.GetHolesFor(ce);ci=(cj=null,[ch.TryGetValue(cf,{get:function(){return cj;},set:function(cl){cj=cl;}}),cj]);return ci[0]?ci[1]:(ck=cg(),(ch.set_Item(cf,ck),ck));};$.GetHolesFor=function(ce){var cf,cg,ch;$.$cctor();cf=(cg=null,[$.initialized.TryGetValue(ce,{get:function(){return cg;},set:function(ci){cg=ci;}}),cg]);return cf[0]?cf[1]:(ch=new U.New$5(),($.initialized.set_Item(ce,ch),ch));};ba.$cctor=function(){ba.$cctor=a.ignore;ba.LoadedTemplates=new U.New$5();ba.LocalTemplatesLoaded=false;ba.GlobalHoles=new U.New$5();ba.TextHoleRE="\\${([^}]+)}";ba.RenderedFullDocTemplate=null;};bc.New$1=function(ce,cf){return{Parse:ce,Write:cf};};bd=V.Route=ca.Class({ToLink:function(){return bK.WriteLink(this.Segments,this.QueryArgs);}},null,bd);bd.Segment=function(ce,cf){var cg;cg=bd.get_Empty();return bd.New(ce,cg.QueryArgs,cg.FormData,cf,cg.Body);};bd.FromUrl=function(ce,cf){var cg,ch,ci;cg=(ch=ce.indexOf("?"),ch===-1?[ce,new bv.New([])]:[H.Substring(ce,0,ch),bd.ParseQuery(ce.substring(ch+1))]);ci=bd.get_Empty();return bd.New(s.ofArray(H.SplitChars(cg[0],["/"],cf!=null&&cf.$0?0:1)),cg[1],ci.FormData,ci.Method,ci.Body);};bd.get_Empty=function(){return bd.New(O.Empty,new bv.New([]),new bv.New([]),null,bJ.CreateFromValue(null));};bd.ParseQuery=function(ce){return bw.OfArray(q.ofSeq(q.choose(function(cf){var cg,ch;cg=H.SplitChars(cf,["="],0);return!w.Equals(cg,null)&&cg.length===2?(ch=q.get(cg,1),{$:1,$0:[q.get(cg,0),ch]}):((function(ci){return function(cj){return ci("wrong format for query argument: "+I.toSafe(cj));};}(function(ci){cb.log(ci);}))(cf),null);},H.SplitChars(ce,["&"],0))));};bd.Combine=function(ce){var cf,cg,ch,ci,cj,ck,cl;cf=q.ofSeq(ce);cg=q.length(cf);return cg===0?bd.get_Empty():cg===1?q.get(cf,0):(ch=null,ci=null,cj=[],ck=new bv.New([]),cl=new bv.New([]),q.iter(function(cm){var cn,co;cn=cm.Method;if(cn!=null&&cn.$==1)ch=cn;co=cm.Body.f();if(co===null);else ci=co;ck=bw.FoldBack(function(cp,cq,cr){return cr.Add(cp,cq);},ck,cm.QueryArgs);cl=bw.FoldBack(function(cp,cq,cr){return cr.Add(cp,cq);},cl,cm.FormData);s.iter(function(cp){cj.push(cp);},cm.Segments);},cf),bd.New(s.ofSeq(cj),ck,cl,ch,bJ.CreateFromValue(ci)));};bd.New=function(ce,cf,cg,ch,ci){return new bd({Segments:ce,QueryArgs:cf,FormData:cg,Method:ch,Body:ci});};be.startsWith=function(ce,cf){var cg;switch(ce.$==1?cf.$==1?w.Equals(ce.$0,cf.$0)?(cg=[cf.$0,cf.$1,ce.$0,ce.$1],1):2:2:0){case 0:return{$:1,$0:cf};case 1:return be.startsWith(cg[3],cg[1]);case 2:return null;}};bf.ofObj=function(ce){return ce==null?null:{$:1,$0:ce};};bh.Int=function(){bh.set_counter(bh.counter()+1);return bh.counter();};bh.set_counter=function(ce){bL.$cctor();bL.counter=ce;};bh.counter=function(){bL.$cctor();return bL.counter;};bi.Map=function(ce,cf){return cf.$==1?{$:1,$0:cf.$0}:{$:0,$0:ce(cf.$0)};};bj=g.DocElemNode=ca.Class({Equals:function(ce){return this.ElKey===ce.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bj);bj.New=function(ce,cf,cg,ch,ci,cj){var ck;return new bj((ck={Attr:ce,Children:cf,El:ch,ElKey:ci},(ca.SetOptional(ck,"Delimiters",cg),ca.SetOptional(ck,"Render",cj),ck)));};R.Obsolete=function(ce){var cf,cg,ch,ci,cj;cg=ce.s;if(cg==null||(cg!=null&&cg.$==2?(cf=cg.$1,false):cg!=null&&cg.$==3?(cf=cg.$1,false):true))void 0;else{ce.s=null;for(ch=0,ci=q.length(cf)-1;ch<=ci;ch++){cj=q.get(cf,ch);if(typeof cj=="object")(function(ck){R.Obsolete(ck);}(cj));else cj();}}};R.New=function(ce){return{s:ce};};bl.New=function(ce,cf,cg,ch,ci){return{Node:ce,Left:cf,Right:cg,Height:ch,Count:ci};};bm=g.DynamicAttrNode=ca.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(ce){return bs.get_Empty();},NGetEnterAnim:function(ce){return bs.get_Empty();},NGetChangeAnim:function(ce){return bs.get_Empty();},NSync:function(ce){if(this.dirty){(this.push(ce))(this.value);this.dirty=false;}}},f,bm);bm.New=ca.Ctor(function(ce,cf){var cg;cg=this;f.New.call(this);this.push=cf;this.value=void 0;this.dirty=false;this.updates=u.Map(function(ch){cg.value=ch;cg.dirty=true;},ce);},bm);bn.notPresent=function(){return e.FailWith("The given key was not present in the dictionary.");};bo=_9.T=ca.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},f,bo);bo.New=ca.Ctor(function(ce,cf,cg,ch){f.New.call(this);this.s=ce;this.c=cf;this.n=cg;this.d=ch;},bo);bp.convertTextNode=function(ce){var cf,cg,ch,ci,cj,ck;cf=null;cg=0;ci=ce.textContent;cj=new a.RegExp(B.TextHoleRE(),"g");while(cf=cj.exec(ci),cf!==null){ce.parentNode.insertBefore(self.document.createTextNode(bq.string(ci,{$:1,$0:cg},{$:1,$0:cj.lastIndex-q.get(cf,0).length-1})),ce);cg=cj.lastIndex;ck=self.document.createElement("span");ck.setAttribute("ws-replace",q.get(cf,1).toLowerCase());ce.parentNode.insertBefore(ck,ce);}cj.lastIndex=0;ce.textContent=bq.string(ci,{$:1,$0:cg},null);};bp.failNotLoaded=function(ce){cb.warn("Instantiating non-loaded template",ce);};bp.fillTextHole=function(ce,cf,cg){var ch;ch=ce.querySelector("[ws-replace]");return w.Equals(ch,null)?(cb.warn("Filling non-existent text hole",cg),null):(ch.parentNode.replaceChild(self.document.createTextNode(cf),ch),{$:1,$0:ch.getAttribute("ws-replace")});};bp.removeHolesExcept=function(ce,cf){function cg(ch){B.foreachNotPreserved(ce,"["+ch+"]",function(ci){if(!cf.Contains(ci.getAttribute(ch)))ci.removeAttribute(ch);});}cg("ws-attr");cg("ws-onafterrender");cg("ws-var");B.foreachNotPreserved(ce,"[ws-hole]",function(ch){if(!cf.Contains(ch.getAttribute("ws-hole"))){ch.removeAttribute("ws-hole");while(ch.hasChildNodes())ch.removeChild(ch.lastChild);}});B.foreachNotPreserved(ce,"[ws-replace]",function(ch){if(!cf.Contains(ch.getAttribute("ws-replace")))ch.parentNode.removeChild(ch);});B.foreachNotPreserved(ce,"[ws-on]",function(ch){ch.setAttribute("ws-on",H.concat(" ",q.filter(function(ci){return cf.Contains(q.get(H.SplitChars(ci,[":"],1),1));},H.SplitChars(ch.getAttribute("ws-on"),[" "],1))));});B.foreachNotPreserved(ce,"[ws-attr-holes]",function(ch){var ci,cj,ck,cl,cm;ci=H.SplitChars(ch.getAttribute("ws-attr-holes"),[" "],1);for(cj=0,ck=ci.length-1;cj<=ck;cj++){cl=q.get(ci,cj);ch.setAttribute(cl,(cm=new a.RegExp(B.TextHoleRE(),"g"),ch.getAttribute(cl).replace(cm,function(cn,co){return cf.Contains(co)?cn:"";})));}});};bp.fillInstanceAttrs=function(ce,cf){var cg,ch,ci,cj,ck;bp.convertAttrs(cf);cg=cf.nodeName.toLowerCase();ch=ce.querySelector("[ws-attr="+cg+"]");if(w.Equals(ch,null))cb.warn("Filling non-existent attr hole",cg);else{ch.removeAttribute("ws-attr");for(ci=0,cj=cf.attributes.length-1;ci<=cj;ci++){ck=cf.attributes.item(ci);if(ck.name==="class"&&ch.hasAttribute("class"))ch.setAttribute("class",ch.getAttribute("class")+" "+ck.nodeValue);else ch.setAttribute(ck.name,ck.nodeValue);}}};bp.mapHoles=function(ce,cf){function cg(ch){B.foreachNotPreserved(ce,"["+ch+"]",function(ci){var cj,ck;cj=(ck=null,[cf.TryGetValue(ci.getAttribute(ch).toLowerCase(),{get:function(){return ck;},set:function(cl){ck=cl;}}),ck]);if(cj[0])ci.setAttribute(ch,cj[1]);});}cg("ws-hole");cg("ws-replace");cg("ws-attr");cg("ws-onafterrender");cg("ws-var");B.foreachNotPreserved(ce,"[ws-on]",function(ch){ch.setAttribute("ws-on",H.concat(" ",q.map(function(ci){var cj,ck,cl;cj=H.SplitChars(ci,[":"],1);ck=(cl=null,[cf.TryGetValue(q.get(cj,1),{get:function(){return cl;},set:function(cm){cl=cm;}}),cl]);return ck[0]?q.get(cj,0)+":"+ck[1]:ci;},H.SplitChars(ch.getAttribute("ws-on"),[" "],1))));});B.foreachNotPreserved(ce,"[ws-attr-holes]",function(ch){var ci,cj,ck;ci=H.SplitChars(ch.getAttribute("ws-attr-holes"),[" "],1);for(cj=0,ck=ci.length-1;cj<=ck;cj++)(function(){var cl;function cm(cn,co){var cp;cp=e.KeyValue(co);return cn.replace(new a.RegExp("\\${"+cp[0]+"}","ig"),"${"+cp[1]+"}");}cl=q.get(ci,cj);return ch.setAttribute(cl,(((ca.Curried3(v.fold))(cm))(ch.getAttribute(cl)))(cf));}());});};bp.fill=function(ce,cf,cg){while(true)if(ce.hasChildNodes())cg=cf.insertBefore(ce.lastChild,cg);else return null;};bp.convertAttrs=function(ce){var cg,ch,ci,cj,ck,cl,cm,cn;function cf(co){var cp;cp=ce.getAttribute(co);if(cp===null);else ce.setAttribute(co,cp.toLowerCase());}cg=ce.attributes;ch=[];ci=[];cj=[];for(ck=0,cl=cg.length-1;ck<=cl;ck++){cm=cg.item(ck);if(H.StartsWith(cm.nodeName,"ws-on")&&cm.nodeName!=="ws-onafterrender"&&cm.nodeName!=="ws-on"){ch.push(cm.nodeName);ci.push(bq.string(cm.nodeName,{$:1,$0:"ws-on".length},null)+":"+cm.nodeValue.toLowerCase());}else!H.StartsWith(cm.nodeName,"ws-")&&(new a.RegExp(B.TextHoleRE())).test(cm.nodeValue)?(cm.nodeValue=(cn=new a.RegExp(B.TextHoleRE(),"g"),cm.nodeValue.replace(cn,function(co,cp){return"${"+cp.toLowerCase()+"}";})),cj.push(cm.nodeName)):void 0;}if(!(ci.length==0))ce.setAttribute("ws-on",H.concat(" ",ci));if(!(cj.length==0))ce.setAttribute("ws-attr-holes",H.concat(" ",cj));cf("ws-hole");cf("ws-replace");cf("ws-attr");cf("ws-onafterrender");cf("ws-var");q.iter(function(co){ce.removeAttribute(co);},ch);};bq.string=function(ce,cf,cg){var ch,ci;return cf==null?cg!=null&&cg.$==1?(ch=cg.$0,ch<0?"":ce.slice(0,ch+1)):"":cg==null?ce.slice(cf.$0):(ci=cg.$0,ci<0?"":ce.slice(cf.$0,ci+1));};br=M.KeyCollection=ca.Class({GetEnumerator$1:function(){return _9.Get(v.map(function(ce){return ce.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},f,br);br.New=ca.Ctor(function(ce){f.New.call(this);this.d=ce;},br);bs.get_UseAnimations=function(){return bG.UseAnimations();};bs.Play=function(ce){var cf;cf=null;return bx.Delay(function(){return bx.Bind(bs.Run(a.ignore,bG.Actions(ce)),function(){bG.Finalize(ce);return bx.Return(null);});});};bs.Append=function(ce,cf){return{$:0,$0:bQ.Append(ce.$0,cf.$0)};};bs.Run=function(ce,cf){var cg;function ch(ci){function cj(ck){return function(cl){var cm;cm=cl-ck;cf.Compute(cm);ce();return cm<=cg?void a.requestAnimationFrame(function(cn){(cj(ck))(cn);}):ci();};}a.requestAnimationFrame(function(ck){(cj(ck))(ck);});}cg=cf.Duration;return cg===0?bx.Zero():bx.FromContinuations(function(ci,cj,ck){return ch.apply(null,[ci,cj,ck]);});};bs.Concat=function(ce){return{$:0,$0:bQ.Concat(v.map(bG.List,ce))};};bs.get_Empty=function(){return{$:0,$0:bQ.Empty()};};bt.BatchUpdatesEnabled=function(){bH.$cctor();return bH.BatchUpdatesEnabled;};bu.StartProcessor=function(ce){var cf;function cg(){var ch;ch=null;return bx.Delay(function(){return bx.Bind(ce,function(){var ci;ci=cf[0];return w.Equals(ci,1)?(cf[0]=0,bx.Zero()):w.Equals(ci,2)?(cf[0]=1,cg()):bx.Zero();});});}cf=[0];return function(){var ch;ch=cf[0];if(w.Equals(ch,0)){cf[0]=1;bx.Start(cg(),null);}else w.Equals(ch,1)?cf[0]=2:void 0;};};bv=M.FSharpMap=ca.Class({Equals:function(ce){return this.get_Count()===ce.get_Count()&&v.forall2(w.Equals,this,ce);},GetEnumerator$1:function(){return _9.Get(v.map(function(ce){return{K:ce.Key,V:ce.Value};},Z.Enumerate(false,this.tree)));},get_Count:function(){var ce;ce=this.tree;return ce==null?0:ce.Count;},GetHashCode:function(){return w.Hash(q.ofSeq(this));},get_IsEmpty:function(){return this.tree==null;},Add:function(ce,cf){return new bv.New$1(Z.Add(bI.New(ce,cf),this.tree));},get_Tree:function(){return this.tree;},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(ce){return v.compareWith(w.Compare,this,ce);}},f,bv);bv.New=ca.Ctor(function(ce){bv.New$1.call(this,bU.fromSeq(ce));},bv);bv.New$1=ca.Ctor(function(ce){f.New.call(this);this.tree=ce;},bv);bw.OfArray=function(ce){return new bv.New$1(Z.OfSeq(v.map(function(cf){return bI.New(cf[0],cf[1]);},ce)));};bw.FoldBack=function(ce,cf,cg){return v.fold(function(ch,ci){return ce(ci.Key,ci.Value,ch);},cg,Z.Enumerate(true,cf.get_Tree()));};bw.ToSeq=function(ce){return v.map(function(cf){return[cf.Key,cf.Value];},Z.Enumerate(false,ce.get_Tree()));};bx.Delay=function(ce){return function(cf){try{(ce(null))(cf);}catch(cg){cf.k({$:1,$0:cg});}};};bx.Bind=function(ce,cf){return bx.checkCancel(function(cg){ce(b0.New(function(ch){var ci;if(ch.$==0){ci=ch.$0;bx.scheduler().Fork(function(){try{(cf(ci))(cg);}catch(cj){cg.k({$:1,$0:cj});}});}else bx.scheduler().Fork(function(){cg.k(ch);});},cg.ct));});};bx.Zero=function(){b1.$cctor();return b1.Zero;};bx.Start=function(ce,cf){var cg,ch;cg=(ch=(bx.defCTS())[0],cf==null?ch:cf.$0);bx.scheduler().Fork(function(){if(!cg.c)ce(b0.New(function(ci){if(ci.$==1)bx.UncaughtAsyncError(ci.$0);},cg));});};bx.Return=function(ce){return function(cf){cf.k({$:0,$0:ce});};};bx.scheduler=function(){b1.$cctor();return b1.scheduler;};bx.checkCancel=function(ce){return function(cf){if(cf.ct.c)bx.cancel(cf);else ce(cf);};};bx.defCTS=function(){b1.$cctor();return b1.defCTS;};bx.UncaughtAsyncError=function(ce){cb.log("WebSharper: Uncaught asynchronous exception",ce);};bx.FromContinuations=function(ce){return function(cf){var cg;function ch(ci){if(cg[0])e.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{cg[0]=true;bx.scheduler().Fork(ci);}}cg=[false];ce(function(ci){ch(function(){cf.k({$:0,$0:ci});});},function(ci){ch(function(){cf.k({$:1,$0:ci});});},function(ci){ch(function(){cf.k({$:2,$0:ci});});});};};bx.cancel=function(ce){ce.k({$:2,$0:new b9.New(ce.ct)});};by=E.ErrorMessage=ca.Class({},f,by);bz.$cctor=function(){var ce;bz.$cctor=a.ignore;bz.lastId=[0];bz.Int=(ce=[0],function(){ce[0]++;return ce[0];});};bB.New=function(ce,cf,cg,ch){var ci;ci={DynElem:ce,DynFlags:cf,DynNodes:cg};ca.SetOptional(ci,"OnAfterRender",ch);return ci;};bC=g.Elt=ca.Class({},l,bC);bC.TreeNode=function(ce,cf){var cg,ch;function ci(cj){return cj[1];}cg=bM.Create(cf);return new bC.New$1({$:6,$0:ce},u.Map2Unit((ch=q.map(function(cj){return _7.Updates(ci(cj));},ce.Attrs),_1.TreeReduce(u.Const(),u.Map2Unit,ch)),cg.v),q.get(ce.Els,0),cg);};bC.New=function(ce,cf,cg){var ch,ci;ch=_2.CreateElemNode(ce,cf,cg.docNode);ci=bM.Create(cg.updates);return new bC.New$1({$:1,$0:ch},u.Map2Unit(_7.Updates(ch.Attr),ci.v),ce,ci);};bC.New$1=ca.Ctor(function(ce,cf,cg,ch){l.New.call(this,ce,cf);this.docNode$1=ce;this.updates$1=cf;this.elt=cg;this.rvUpdates=ch;},bC);bE.New=function(ce,cf){return{PreviousNodes:ce,Top:cf};};bF.get_Empty=function(){return{$:0,$0:new _.New$3()};};bF.FindAll=function(ce){var cf;function cg(cj,ck){var cl,cm,cn,co,cp;while(true)switch(cj){case 0:if(ck!=null&&ck.$==0){cm=ck.$1;cn=ck.$0;cg(0,cn);ck=cm;}else if(ck!=null&&ck.$==1){co=ck.$0;ck=co;cj=1;}else if(ck!=null&&ck.$==2){cp=ck.$0;ck=cp.Current;}else return ck!=null&&ck.$==6?(cl=ck.$0.Holes,(function(cq){return function(cr){q.iter(cq,cr);};}(ci))(cl)):null;break;case 1:cf.push(ck);ck=ck.Children;cj=0;break;}}function ch(cj){return cg(0,cj);}function ci(cj){return cg(1,cj);}cf=[];ch(ce);return{$:0,$0:new _.New$2(cf)};};bF.Filter=function(ce,cf){return{$:0,$0:b3.Filter(ce,cf.$0)};};bF.Except=function(ce,cf){return{$:0,$0:b3.Except(ce.$0,cf.$0)};};bF.ToArray=function(ce){return b3.ToArray(ce.$0);};bF.Intersect=function(ce,cf){return{$:0,$0:b3.Intersect(ce.$0,cf.$0)};};bG.UseAnimations=function(){bP.$cctor();return bP.UseAnimations;};bG.Actions=function(ce){return bG.ConcatActions(q.choose(function(cf){return cf.$==1?{$:1,$0:cf.$0}:null;},bQ.ToArray(ce.$0)));};bG.Finalize=function(ce){q.iter(function(cf){if(cf.$==0)cf.$0();},bQ.ToArray(ce.$0));};bG.ConcatActions=function(ce){var cf,cg,ch,ci;cf=_1.ofSeqNonCopying(ce);cg=q.length(cf);return cg===0?bG.Const():cg===1?q.get(cf,0):(ch=v.max(v.map(function(cj){return cj.Duration;},cf)),(ci=q.map(function(cj){return bG.Prolong(ch,cj);},cf),bG.Def(ch,function(cj){q.iter(function(ck){ck.Compute(cj);},ci);})));};bG.List=function(ce){return ce.$0;};bG.Const=function(ce){return bG.Def(0,function(){return ce;});};bG.Def=function(ce,cf){return{Compute:cf,Duration:ce};};bG.Prolong=function(ce,cf){var cg,ch,ci;cg=cf.Compute;ch=cf.Duration;ci=bJ.Create(function(){return cf.Compute(cf.Duration);});return{Compute:function(cj){return cj>=ch?ci.f():cg(cj);},Duration:ce};};bH.$cctor=function(){bH.$cctor=a.ignore;bH.BatchUpdatesEnabled=true;};bI=M.Pair=ca.Class({Equals:function(ce){return w.Equals(this.Key,ce.Key);},GetHashCode:function(){return w.Hash(this.Key);},CompareTo0:function(ce){return w.Compare(this.Key,ce.Key);}},null,bI);bI.New=function(ce,cf){return new bI({Key:ce,Value:cf});};bJ.CreateFromValue=function(ce){return bT.New(true,ce,bJ.cachedLazy);};bJ.cachedLazy=function(){return this.v;};bJ.Create=function(ce){return bT.New(false,ce,bJ.forceLazy);};bJ.forceLazy=function(){var ce;ce=this.v();this.c=true;this.v=ce;this.f=bJ.cachedLazy;return ce;};bK.WriteLink=function(ce,cf){var cg;cg=cf.get_IsEmpty()?"":"?"+bK.WriteQuery(cf);return"/"+bK.Concat(ce)+cg;};bK.Concat=function(ce){var cf,cg;cf=[];cg=true;s.iter(function(ch){if(!H.IsNullOrEmpty(ch)){cg?cg=false:cf.push("/");cf.push(ch);}},ce);return H.Join("",q.ofSeq(cf));};bK.WriteQuery=function(ce){function cf(cg,ch){return cg+"="+ch;}return H.concat("&",v.map(function(cg){return cf(cg[0],cg[1]);},bw.ToSeq(ce)));};bL.$cctor=function(){bL.$cctor=a.ignore;bL.counter=0;};bM=g.Updates=ca.Class({},null,bM);bM.Create=function(ce){var cf;cf=null;cf=bM.New(ce,null,function(){var cg;cg=cf.s;return cg===null?(cg=R.Copy(cf.c()),cf.s=cg,R.WhenObsoleteRun(cg,function(){cf.s=null;}),cg):cg;});return cf;};bM.New=function(ce,cf,cg){return new bM({c:ce,s:cf,v:cg});};bN=M.ValueCollection=ca.Class({GetEnumerator$1:function(){return _9.Get(v.map(function(ce){return ce.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},f,bN);bN.New=ca.Ctor(function(ce){f.New.call(this);this.d=ce;},bN);bO.$cctor=function(){var ce;bO.$cctor=a.ignore;bO.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bO.rtagName=new a.RegExp("<([\\w:]+)");bO.rhtml=new a.RegExp("<|&#?\\w+;");bO.wrapMap=(ce=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:ce,tbody:ce,tfoot:ce,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bO.defaultWrap=[0,"",""];};bP.$cctor=function(){bP.$cctor=a.ignore;bP.CubicInOut=bZ.Custom(function(ce){var cf;cf=ce*ce;return 3*cf-2*(cf*ce);});bP.UseAnimations=true;};bQ.Append=function(ce,cf){return ce.$==0?cf:cf.$==0?ce:{$:2,$0:ce,$1:cf};};bQ.ToArray=function(ce){var cf;function cg(ch){var ci,cj;while(true)if(ch.$==1)return cf.push(ch.$0);else if(ch.$==2){ci=ch.$1;cj=ch.$0;cg(cj);ch=ci;}else return ch.$==3?q.iter(function(ck){cf.push(ck);},ch.$0):null;}cf=[];cg(ce);return cf.slice(0);};bQ.Concat=function(ce){var cf;cf=_1.ofSeqNonCopying(ce);return _1.TreeReduce(bQ.Empty(),bQ.Append,cf);};bQ.Empty=function(){b_.$cctor();return b_.Empty;};bR.concat=function(ce){var cf,cg;cf=[];for(var ch in ce)cf.push.apply(cf,ce[ch]);return cf;};bT.New=function(ce,cf,cg){return{c:ce,v:cf,f:cg};};bU.fromSeq=function(ce){var cf;cf=q.ofSeq(v.map(function(cg){return bI.New(cg[0],cg[1]);},v.distinctBy(function(cg){return cg[0];},v.rev(ce))));q.sortInPlace(cf);return Z.Build(cf,0,cf.length-1);};bV=bx.Scheduler=ca.Class({Fork:function(ce){var cf;cf=this;this.robin.push(ce);if(this.idle){this.idle=false;a.setTimeout(function(){cf.tick();},0);}},tick:function(){var ce,cf,cg;cf=this;cg=cd.now();ce=true;while(ce)if(this.robin.length===0){this.idle=true;ce=false;}else{(this.robin.shift())();cd.now()-cg>40?(a.setTimeout(function(){cf.tick();},0),ce=false):void 0;}}},f,bV);bV.New=ca.Ctor(function(){f.New.call(this);this.idle=true;this.robin=[];},bV);bW.Clear=function(ce){ce.splice(0,q.length(ce));};bX.StringApply=function(){bY.$cctor();return bY.StringApply;};bX.BoolCheckedApply=function(){bY.$cctor();return bY.BoolCheckedApply;};bX.IntApplyChecked=function(){bY.$cctor();return bY.IntApplyChecked;};bX.IntApplyUnchecked=function(){bY.$cctor();return bY.IntApplyUnchecked;};bX.FloatApplyChecked=function(){bY.$cctor();return bY.FloatApplyChecked;};bX.FloatApplyUnchecked=function(){bY.$cctor();return bY.FloatApplyUnchecked;};bX.ApplyValue=function(ce,cf,cg){var ch;function ci(cj,ck){return ck==null?null:cj(ck.$0);}ch=null;return[function(cj){function ck(){cg.UpdateMaybe(function(cl){var cm;ch=ce(cj);return ch!=null&&ch.$==1&&(!w.Equals(ch.$0,cl)&&(cm=[ch,ch.$0],true))?cm[0]:null;});}cj.addEventListener("change",ck);cj.addEventListener("input",ck);cj.addEventListener("keypress",ck);},function(cj){var ck;ck=cf(cj);return function(cl){return ci(ck,cl);};},u.Map(function(cj){var ck;return ch!=null&&ch.$==1&&(w.Equals(ch.$0,cj)&&(ck=ch.$0,true))?null:{$:1,$0:cj};},cg.get_View())];};bX.StringSet=function(){bY.$cctor();return bY.StringSet;};bX.StringGet=function(){bY.$cctor();return bY.StringGet;};bX.IntSetUnchecked=function(){bY.$cctor();return bY.IntSetUnchecked;};bX.IntGetUnchecked=function(){bY.$cctor();return bY.IntGetUnchecked;};bX.IntSetChecked=function(){bY.$cctor();return bY.IntSetChecked;};bX.IntGetChecked=function(){bY.$cctor();return bY.IntGetChecked;};bX.FloatSetUnchecked=function(){bY.$cctor();return bY.FloatSetUnchecked;};bX.FloatGetUnchecked=function(){bY.$cctor();return bY.FloatGetUnchecked;};bX.FloatSetChecked=function(){bY.$cctor();return bY.FloatSetChecked;};bX.FloatGetChecked=function(){bY.$cctor();return bY.FloatGetChecked;};bY.$cctor=function(){var ce,cf,cg,ch,ci,cj,ck,cl,cm,cn;bY.$cctor=a.ignore;bY.EmptyAttr=null;bY.BoolCheckedApply=function(co){function cp(cq,cr){return cr!=null&&cr.$==1?void(cq.checked=cr.$0):null;}return[function(cq){cq.addEventListener("change",function(){return!w.Equals(co.Get(),cq.checked)?co.Set(cq.checked):null;});},function(cq){return function(cr){return cp(cq,cr);};},u.Map(function(cq){return{$:1,$0:cq};},co.get_View())];};bY.StringSet=function(co){return function(cp){co.value=cp;};};bY.StringGet=function(co){return{$:1,$0:co.value};};bY.StringApply=(ce=bX.StringGet(),(cf=bX.StringSet(),function(co){return bX.ApplyValue(ce,cf,co);}));bY.IntSetUnchecked=function(co){return function(cp){co.value=a.String(cp);};};bY.IntGetUnchecked=function(co){var cp,cq;cp=co.value;return b4.isBlank(cp)?{$:1,$0:0}:(cq=+cp,cq!==cq>>0?null:{$:1,$0:cq});};bY.IntApplyUnchecked=(cg=bX.IntGetUnchecked(),(ch=bX.IntSetUnchecked(),function(co){return bX.ApplyValue(cg,ch,co);}));bY.IntSetChecked=function(co){return function(cp){var cq;cq=cp.get_Input();return co.value!==cq?void(co.value=cq):null;};};bY.IntGetChecked=function(co){var cp,cq,cr;cp=co.value;return{$:1,$0:b4.isBlank(cp)?(co.checkValidity?co.checkValidity():true)?new _5({$:2,$0:cp}):new _5({$:1,$0:cp}):(cq=(cr=0,[_6.TryParseInt32(cp,{get:function(){return cr;},set:function(cs){cr=cs;}}),cr]),cq[0]?new _5({$:0,$0:cq[1],$1:cp}):new _5({$:1,$0:cp}))};};bY.IntApplyChecked=(ci=bX.IntGetChecked(),(cj=bX.IntSetChecked(),function(co){return bX.ApplyValue(ci,cj,co);}));bY.FloatSetUnchecked=function(co){return function(cp){co.value=a.String(cp);};};bY.FloatGetUnchecked=function(co){var cp,cq;cp=co.value;return b4.isBlank(cp)?{$:1,$0:0}:(cq=+cp,a.isNaN(cq)?null:{$:1,$0:cq});};bY.FloatApplyUnchecked=(ck=bX.FloatGetUnchecked(),(cl=bX.FloatSetUnchecked(),function(co){return bX.ApplyValue(ck,cl,co);}));bY.FloatSetChecked=function(co){return function(cp){var cq;cq=cp.get_Input();return co.value!==cq?void(co.value=cq):null;};};bY.FloatGetChecked=function(co){var cp,cq;cp=co.value;return{$:1,$0:b4.isBlank(cp)?(co.checkValidity?co.checkValidity():true)?new _5({$:2,$0:cp}):new _5({$:1,$0:cp}):(cq=+cp,a.isNaN(cq)?new _5({$:1,$0:cp}):new _5({$:0,$0:cq,$1:cp}))};};bY.FloatApplyChecked=(cm=bX.FloatGetChecked(),(cn=bX.FloatSetChecked(),function(co){return bX.ApplyValue(cm,cn,co);}));};bZ=g.Easing=ca.Class({},f,bZ);bZ.Custom=function(ce){return new bZ.New(ce);};bZ.New=ca.Ctor(function(ce){f.New.call(this);this.transformTime=ce;},bZ);b0.New=function(ce,cf){return{k:ce,ct:cf};};b1.$cctor=function(){b1.$cctor=a.ignore;b1.noneCT=b2.New(false,[]);b1.scheduler=new bV.New();b1.defCTS=[new b5.New()];b1.Zero=bx.Return();b1.GetCT=function(ce){ce.k({$:0,$0:ce.ct});};};b2.New=function(ce,cf){return{c:ce,r:cf};};b3.Filter=function(ce,cf){return new _.New$2(q.filter(ce,b3.ToArray(cf)));};b3.Except=function(ce,cf){var cg;cg=new _.New$2(b3.ToArray(cf));cg.ExceptWith(b3.ToArray(ce));return cg;};b3.ToArray=function(ce){var cf;cf=q.create(ce.get_Count(),void 0);ce.CopyTo(cf);return cf;};b3.Intersect=function(ce,cf){var cg;cg=new _.New$2(b3.ToArray(ce));cg.IntersectWith(b3.ToArray(cf));return cg;};b4.isBlank=function(ce){return H.forall(b7.IsWhiteSpace,ce);};b5=d.CancellationTokenSource=ca.Class({},f,b5);b5.New=ca.Ctor(function(){f.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},b5);b6.Children=function(ce,cf){var cg,ch,ci;if(cf!=null&&cf.$==1){ci=[];cg=cf.$0[0].nextSibling;while(cg!==cf.$0[1]){ci.push(cg);cg=cg.nextSibling;}return{$:0,$0:ci};}else return{$:0,$0:q.init(ce.childNodes.length,(ch=ce.childNodes,function(cj){return ch[cj];}))};};b6.Except=function(ce,cf){var cg;cg=ce.$0;return{$:0,$0:q.filter(function(ch){return q.forall(function(ci){return!(ch===ci);},cg);},cf.$0)};};b6.Iter=function(ce,cf){q.iter(ce,cf.$0);};b6.DocChildren=function(ce){var cf;function cg(ch){var ci,cj,ck,cl;while(true){if(ch!=null&&ch.$==2){cj=ch.$0;ch=cj.Current;}else if(ch!=null&&ch.$==1)return cf.push(ch.$0.El);else if(ch==null)return null;else if(ch!=null&&ch.$==5)return cf.push(ch.$0);else if(ch!=null&&ch.$==4)return cf.push(ch.$0.Text);else if(ch!=null&&ch.$==6){ci=ch.$0.Els;return(function(cm){return function(cn){q.iter(cm,cn);};}(function(cm){if(cm==null||cm.constructor===_3)cg(cm);else cf.push(cm);}))(ci);}else{ck=ch.$1;cl=ch.$0;cg(cl);ch=ck;}}}cf=[];cg(ce.Children);return{$:0,$0:_1.ofSeqNonCopying(cf)};};b7.IsWhiteSpace=function(ce){return ce.match(new a.RegExp("\\s"))!==null;};_6.TryParse=function(ce,cf,cg,ch){var ci,cj;ci=+ce;cj=ci===ci-ci%1&&ci>=cf&&ci<=cg;if(cj)ch.set(ci);return cj;};b9=d.OperationCanceledException=ca.Class({},b8,b9);b9.New=ca.Ctor(function(ce){b9.New$1.call(this,"The operation was canceled.",null,ce);},b9);b9.New$1=ca.Ctor(function(ce,cf,cg){this.message=ce;this.inner=cf;_3.setPrototypeOf(this,b9.prototype);this.ct=cg;},b9);b_.$cctor=function(){b_.$cctor=a.ignore;b_.Empty={$:0};};ca.OnLoad(function(){c.Main();});}(self));


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
